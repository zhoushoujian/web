(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{203:function(e,a,t){"use strict";var n=t(0),r=t.n(n);a.a=(()=>r.a.createElement("div",{className:"top-status-bar"}))},204:function(e,a,t){"use strict";var n=t(0),r=t.n(n),i=t(203);a.a=(({centerText:e="",backToPreviousPage:a=(()=>{}),rightText:t="",rightTextFunc:l=(()=>{})})=>r.a.createElement(n.Fragment,null,r.a.createElement(i.a,null),r.a.createElement("div",{className:"navbar-container"},r.a.createElement("div",{className:"back-btn",onClick:a},r.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),r.a.createElement("div",{className:"center-text"},e),r.a.createElement("div",{className:"other-text",onClick:l},t))))},513:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),i=t(71),l=t(3),c=t(443),o=(t(200),t(72)),s=t(204),u=t(6),m=t(10),d=t(8),v=t(4),g=t(1);t(189);let p="MV",b=!1,w="",f="";a.default=Object(i.connect)(e=>({userId:e.login.userId}),()=>({}))(({location:e,userId:a})=>{const[t,i]=Object(n.useState)(!1),[y,E]=Object(n.useState)(null),h=Object(n.useRef)(),O=Object(l.useHistory)();e&&e.query&&e.query&&(p=e.query.filename,w=e.query.mvId,f=e.query.original),Object(n.useEffect)(()=>{if(b=!!e.search){const e=Object(d.s)();if(!e.mvId)return alertDialog("视频播放失败, 请稍候再试");w=e.mvId,p=e.filename,f=e.original,a="weChatUser"+Math.random().toString(36).slice(-5)}else e&&e.query||(alertDebug("no location.query"),O.push("/main/myInfo")),document.addEventListener("deviceready",k,!1),Object(d.x)(),document.querySelector(".window-music-controller").style.display="none",Object(d.E)();let t=m.a.getQQMvLink;return f===u.a.musicOriginal.netEaseCloud||f===u.a.musicOriginal.homeRecommend?t=m.a.getNetEaseCloudMvLink:f===u.a.musicOriginal.qqMusic&&(t=m.a.getQQMvLink),axios.get(t.format({id:w,userId:a})).then(e=>{const a=e.data.result;a.response?(i(!0),E(a.response),h.current&&h.current.subscribeToStateChange(q)):(alertDialog("没有视频链接"),b||C("nav"))}).catch(e=>{Object(v.q)(e,"MusicMvPlayer")}),()=>{document.querySelector(".window-music-controller").style.display="flex",j(),document.removeEventListener("deviceready",k),document.removeEventListener("backbutton",C)}},[]);const k=()=>{window.plugins.insomnia.keepAwake(),document.addEventListener("backbutton",C,!1)},C=e=>{b?alert("请手动关闭页面"):("nav"===e&&window.history.back(),setTimeout(()=>{$dispatch(Object(g.cb)(!0))},100))},j=()=>{isCordova&&(window.StatusBar.overlaysWebView(!1),window.StatusBar.backgroundColorByHexString(u.a.statusBarColor),screen.orientation.lock("portrait"),window.plugins.insomnia.allowSleepAgain())},q=(e,a)=>{e.isFullscreen!==a.isFullscreen&&(logger.info("listenVideoState state.isFullscreen, filename",e.isFullscreen,p),logger.info("listenVideoState prevState.isFullscreen, filename",a.isFullscreen,p),e.isFullscreen?isCordova&&(window.StatusBar.overlaysWebView(!0),screen.orientation.lock("landscape")):j())},S=()=>{Object(v.i)()?alertOld("链接打不开?请点击右上角...,选择在浏览器打开"):Object(v.v)({filenameOrigin:"shareMVFromThirdPart",fileUrl:u.a.appDownloadUrl,folder:u.a.downloadAppFromPage})};return r.a.createElement("div",{className:"music-mv-player-container"},r.a.createElement(s.a,{centerText:p,backToPreviousPage:C.bind(void 0,"nav")}),r.a.createElement("div",{className:"music-mv-player-content"},t?r.a.createElement(n.Fragment,null,r.a.createElement(c.Player,{ref:h,autoPlay:!0},r.a.createElement(c.ControlBar,{autoHide:!0}),r.a.createElement("source",{src:y}),r.a.createElement(c.BigPlayButton,{position:"center"})),b?r.a.createElement("div",{className:"weChat-tips"},r.a.createElement("div",{className:"open",onClick:S},"打开"),r.a.createElement("div",{className:"download",onClick:S},"下载")):r.a.createElement("div",{className:"mv-menu"},isCordova?r.a.createElement("i",{className:"fa fa-share share","aria-hidden":"true",onClick:()=>{const e={filename:p,mvId:w,original:f,isFromThirdPart:"weChat"};let a=`${u.a.appStaticDirectory}#/music_mv_Player`;const t=[];for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(`${a}=${e[a]}`);return a=`${a}?${t.join("&")}`,Object(v.x)({title:"MV: "+p,description:"我分享了一个MV,快来看看吧",thumb:`${u.a.appStaticDirectory}logo.png`,videoUrl:a})}}):null,r.a.createElement("i",{className:"fa fa-download download-song","aria-hidden":"true",onClick:()=>{if(b)S();else{const{original:a,filename:t}=e.query,n=a===u.a.musicOriginal.netEaseCloud?"网易云":a===u.a.musicOriginal.qqMusic?"qq音乐":"未知",r=t+".mp4";Object(d.T)(r,n,"未知",y,!1,r,O,null)}}}))):r.a.createElement(o.a,null)))})}}]);