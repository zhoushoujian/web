(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{203:function(e,t,a){"use strict";var n=a(0),s=a.n(n);t.a=(()=>s.a.createElement("div",{className:"top-status-bar"}))},204:function(e,t,a){"use strict";var n=a(0),s=a.n(n),o=a(203);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:r=(()=>{})})=>s.a.createElement(n.Fragment,null,s.a.createElement(o.a,null),s.a.createElement("div",{className:"navbar-container"},s.a.createElement("div",{className:"back-btn",onClick:t},s.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),s.a.createElement("div",{className:"center-text"},e),s.a.createElement("div",{className:"other-text",onClick:r},a))))},208:function(e,t,a){"use strict";var n=a(0),s=a.n(n);const o=Object(n.forwardRef)((e,t)=>{const{type:a="text",placeholder:n="",value:o="",handleKeyDown:r=(()=>{}),handleChange:i=(()=>{}),maxLength:l=26,style:c={},handleClick:u=(()=>{}),handleBlur:f=(()=>{}),className:p}=e;return s.a.createElement("input",{className:`input-component ${p}`,type:a,placeholder:n,value:o,onKeyDown:r,onChange:i,maxLength:l,autoComplete:"off",style:c,onClick:u,onBlur:f,ref:t})});t.a=o},230:function(e,t,a){"use strict";a(217);var n=a(218),s=a.n(n),o=(a(235),a(236)),r=a.n(o),i=a(0),l=a.n(i),c=a(208),u=a(10),f=a(4),p=a(11),m=a(6),d=a(8);var h=function(){this.saveUserInfo=(()=>{const{infoLength:e,infoErrorTip:t,updateUserInfoDispatch:a,pageTitle:n,name:s,backToMainPage:o,self:r}=this.props;let i=this.state.inputValue;const{tryMobileOrEmailTimes:l=0}=$getState().common;if(i.length>e)return alert(t);if(!i)return;if("填写手机号"===n){if(!1===Object(d.k)(i))return alert(t);if(i===$getState().myInfo.setMobile)return;if(l>=3)return alertDialog("您的操作太频繁，请稍后重试")}else if("填写邮箱"===n){if(!1===Object(d.f)(i))return alert("邮箱格式不正确");if(i===$getState().myInfo.setEmail)return;if(l>=3)return alertDialog("您的操作太频繁，请稍后重试")}else if("设置用户名"===n){if(!/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/.test(i))return logger.info("saveUserInfo 用户名只能由字母,数字或中文组成",i),alertDialog("用户名只能由字母，数字或中文组成");if(/^[0-9]/i.test(i))return logger.info("saveUserInfo 用户名首字母不能是数字",i),alertDialog("用户名首字母不能是数字")}i=i.replace(/\s/g,"");const{username:c,token:h}=$getState().login,{setMobile:g}=$getState().myInfo;if(!h)return alertDialog("没有token");const w=Object.assign({},{username:c||g,token:h,userInfo:{[s]:i}});"填写邮箱"!==n&&"填写手机号"!==n||Object(f.A)(),logger.info("UpdateUserInfoComponent saveUserInfo data",w),axios.post(u.a.updateUserInfo,w).then(e=>{if(window.toast.hide(),window.cancelAxiosRequest)return;const{result:t}=e.data;"modify_success"===t.response?(Toast.success("保存成功",m.a.toastTime),$dispatch(Object(p.j)(t.token)),$dispatch(a(i)),o()):"lack_fields"===t.response?Toast.fail("缺少必要的字段",m.a.toastTime):"more_string_length"===t.response?Toast.fail("字数超过长度限制",m.a.toastTime):"wrong_email_format"===t.response?Toast.fail("错误的邮箱格式",m.a.toastTime):"email_existed"===t.response?(window.toast.hide(),alertDialog("此邮箱已绑定到其他账号，请更换邮箱后重试")):"username_existed"===t.response?(window.toast.hide(),alertDialog("此用户名已被注册，请更换后重试")):"send_email_success"===t.response?(Object(d.Z)(l),window.toast.hide(),alert("验证码已发送邮箱，请注意查收"),$dispatch(Object(p.j)(t.token)),$dispatch(a(i)),goRoute(r,"/check_email")):"wrong_mobile_format"===t.response?Toast.fail("错误的手机号格式",m.a.toastTime):"mobile_existed"===t.response?(window.toast.hide(),alertDialog("此手机号已绑定到其他账号，请更换手机号重试")):"mobile_existed_from_register"===t.response?(window.toast.hide(),Object(f.j)("此手机号已被注册","","去登录",()=>{goRoute(r,"/login")})):"send_mobile_success"===t.response?(Object(d.Z)(l),window.toast.hide(),alert("手机验证码已发送，请注意查收"),$dispatch(a(i)),goRoute(r,"/check_mobile")):(logger.error("saveUserInfo updateUserInfo 设置失败 result",t),Toast.fail("设置失败",m.a.toastTime))}).catch(e=>(window.toast.hide(),Object(f.q)(e,`updateUserInfo data: ${w}`))).finally(()=>{window.cancelAxiosRequest=!1})}),this.keyDownEvent=(e=>{if(13===e.keyCode)return this.saveUserInfo()}),this.updateValue=(e=>{let t=e;e.target&&(t=e.target.value),this.setState({inputValue:t})})};t.a=class extends l.a.Component{constructor(e){super(e),h.call(this);const{placeholder:t}=this.props;let a=t;"请输入昵称,最多10个字"!==t&&"请输入手机号"!==t&&"请输入签名"!==t&&"请输入邮箱"!==t&&"用户名可用于登录，全网唯一，设置后不可修改"!==t||(a=""),this.state={inputValue:a},this.userInfoInputRef=Object(i.createRef)()}componentDidMount(){setTimeout(()=>{this.userInfoInputRef&&this.userInfoInputRef.current&&this.userInfoInputRef.current.focus()})}render(){const{pageTitle:e,placeholder:t}=this.props,{inputValue:a}=this.state;return l.a.createElement("div",{className:"set-user-info-component-container"},l.a.createElement("div",{className:"set-user-info-component-content"},"填写手机号"===e?l.a.createElement(r.a,{type:"phone",placeholder:t,onChange:this.updateValue,onKeyDown:this.keyDownEvent}):l.a.createElement(c.a,{value:a,placeholder:t,handleChange:this.updateValue,handleKeyDown:this.keyDownEvent,ref:this.userInfoInputRef}),l.a.createElement("div",{className:"save-user-info"},l.a.createElement(s.a,{type:"primary",className:"button",value:"保存",onClick:this.saveUserInfo},"保存"))))}}},514:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(230),r=a(11),i=a(204);function l(){goRoute(this,"/user_profile")}t.default=function(){return s.a.createElement("div",null,s.a.createElement(i.a,{centerText:"设置用户名",backToPreviousPage:l}),s.a.createElement(o.a,{pageTitle:"设置用户名",placeholder:"用户名可用于登录，全网唯一，设置后不可修改",infoLength:32,infoErrorTip:"用户名不允许超过32个字",updateUserInfoDispatch:r.l,name:"setUsername",backToMainPage:l}))}}}]);