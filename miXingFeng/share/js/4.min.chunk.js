(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{208:function(e,a,t){"use strict";var i=t(0),l=t.n(i);const s=Object(i.forwardRef)((e,a)=>{const{type:t="text",placeholder:i="",value:s="",handleKeyDown:n=(()=>{}),handleChange:c=(()=>{}),maxLength:r=26,style:o={},handleClick:u=(()=>{}),handleBlur:d=(()=>{}),className:m}=e;return l.a.createElement("input",{className:`input-component ${m}`,type:t,placeholder:i,value:s,onKeyDown:n,onChange:c,maxLength:r,autoComplete:"off",style:o,onClick:u,onBlur:d,ref:a})});a.a=s},214:function(e,a,t){"use strict";t(70),t(184)},215:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=d(t(12)),l=d(t(21)),s=d(t(14)),n=d(t(15)),c=d(t(13)),r=d(t(16)),o=d(t(24)),u=function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t]);return a.default=e,a}(t(0));function d(e){return e&&e.__esModule?e:{default:e}}var m=function(e,a){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&a.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(i=Object.getOwnPropertySymbols(e);l<i.length;l++)a.indexOf(i[l])<0&&(t[i[l]]=e[i[l]])}return t},h=function(e){function a(){return(0,s.default)(this,a),(0,c.default)(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return(0,r.default)(a,e),(0,n.default)(a,[{key:"render",value:function(){var e,a,t=this.props,s=t.className,n=t.prefixCls,c=t.children,r=t.text,d=t.size,h=t.overflowCount,g=t.dot,f=t.corner,O=t.hot,p=m(t,["className","prefixCls","children","text","size","overflowCount","dot","corner","hot"]);h=h,r="number"==typeof r&&r>h?h+"+":r,g&&(r="");var b=(0,o.default)((e={},(0,l.default)(e,n+"-dot",g),(0,l.default)(e,n+"-dot-large",g&&"large"===d),(0,l.default)(e,n+"-text",!g&&!f),(0,l.default)(e,n+"-corner",f),(0,l.default)(e,n+"-corner-large",f&&"large"===d),e)),S=(0,o.default)(n,s,(a={},(0,l.default)(a,n+"-not-a-wrapper",!c),(0,l.default)(a,n+"-corner-wrapper",f),(0,l.default)(a,n+"-hot",!!O),(0,l.default)(a,n+"-corner-wrapper-large",f&&"large"===d),a));return u.createElement("span",{className:S},c,(r||g)&&u.createElement("sup",(0,i.default)({className:b},p),r))}}]),a}(u.Component);a.default=h,h.defaultProps={prefixCls:"am-badge",size:"small",overflowCount:99,dot:!1,corner:!1},e.exports=a.default},221:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){return Object.keys(e).reduce(function(a,t){return"aria-"!==t.substr(0,5)&&"data-"!==t.substr(0,5)&&"role"!==t||(a[t]=e[t]),a},{})},e.exports=a.default},228:function(e,a,t){"use strict";t(222);var i=t(223),l=t.n(i),s=(t(219),t(220)),n=t.n(s),c=t(0),r=t.n(c),o=t(71),u=t(3),d=t(73),m=t(10),h=t(234),g=t(51),f=t(1),O=t(4),p=t(11),b=t(8),S=t(6),v=t(33),M=t(23);let j;new RegExp("\\biPhone\\b|\\biPod\\b","i").test(navigator.userAgent)&&(j={onTouchStart:e=>e.preventDefault()});a.a=Object(o.connect)(e=>({soundPlaying:e.fileServer.soundPlaying,soundInstance:e.fileServer.soundInstance,currentPlayingSong:e.fileServer.currentPlayingSong,currentSongTime:e.fileServer.currentSongTime,pauseWhenOver:e.fileServer.pauseWhenOver,playByOrder:e.fileServer.playByOrder,musicCollection:e.fileServer.musicCollection,musicMenuBadge:e.fileServer.musicMenuBadge,username:e.login.username,token:e.login.token,playByRandom:e.fileServer.playByRandom,lastMusicSearchResult:e.fileServer.lastMusicSearchResult,lastSearchAllMusicResult:e.fileServer.lastSearchAllMusicResult,downloadingMusicItems:e.fileServer.downloadingMusicItems,downloadedMusicList:e.fileServer.downloadedMusicList,currentPlayingSongOriginal:e.fileServer.currentPlayingSongOriginal,recentMusicList:e.fileServer.recentMusicList,musicPageType:e.fileServer.musicPageType,setMobile:e.myInfo.setMobile,showMusicPlayingFromMusicControl:e.fileServer.showMusicPlayingFromMusicControl,notExistMusicPlayingPage:e.fileServer.notExistMusicPlayingPage}),()=>({}))(({original:e,soundInstance:a,currentPlayingSong:t,currentSongTime:i,soundPlaying:s,pageType:o,pauseWhenOver:E,playByOrder:y,musicCollection:N=[],musicMenuBadge:w,username:$,token:k,playByRandom:R,setMobile:x,musicDataList:A,lastMusicSearchResult:C,lastSearchAllMusicResult:F,recentMusicList:P,noShowMusicPlaying:L=!1,myMusicPage:q=!1,searchMusicPage:D=!1,notExistMusicPlayingPage:K=!1,showBottomLine:T=!1,musicPlayerRef:Q,loadingRecommendSongs:W=!1})=>{const I=Object(u.useHistory)(),[_,G]=Object(c.useState)(!0);Object(c.useEffect)(()=>(d.Howler.volume(.8),e!==S.a.musicOriginal.musicDownloading&&a&&Object(b.v)(),document.addEventListener("deviceready",J,!1),()=>{document.removeEventListener("deviceready",J,!1),document.removeEventListener("backbutton",B,!1)}),[]);const J=()=>{document.addEventListener("backbutton",B,!1)},B=()=>{if(!window.cancelMenuFirst&&!window.specialBack)if($getState().fileServer.showMusicPlayingFromMusicControl||Object(O.h)())Object(O.y)();else if(q)Object(O.b)("/my_download_middle_page",!0);else{if(!D)return;Object(O.b)("/search_column",!0)}},z=()=>{window.cancelMenuFirst=!0,document.addEventListener("backbutton",H)},U=()=>{window.cancelMenuFirst&&(window.cancelMenuFirst=!1,document.removeEventListener("backbutton",H),document.removeEventListener("deviceready",z),document.addEventListener("backbutton",O.r))},H=()=>{const e=document.querySelector(".am-action-sheet-button-list div:nth-last-child(1)");e&&e.click()},V=(e,a,t,i,l,s,n)=>{Object(O.j)("提示",r.a.createElement(g.a,{textFragment:`确定从本地删除 <span class="delete-alert">${e}</span> 吗`}),"确定",()=>Object(b.M)(Object(b.N)(a),"music").then(()=>{Y(s,a),a===t&&Object(b.r)(i,l,s,n)}).catch(e=>{logger.error("删除音乐过程中发生了错误 isFileFinished",e.stack||e.toString()),Object(O.q)(e,`musicPlayer removeFileFromDownload filenameOrigin: ${a}`)}))},Y=(e,a)=>{if(e===S.a.musicOriginal.musicSearch){let e,t;C.some((t,i)=>Object(b.N)(t.filenameOrigin)===Object(b.N)(a)&&(e=i,!0));const i=JSON.parse(JSON.stringify(C));i.splice(e,1),F.some((e,i)=>Object(b.N)(e.filenameOrigin)===Object(b.N)(a)&&(t=i,!0));const l=JSON.parse(JSON.stringify(F));l.splice(t,1),$dispatch(Object(f.w)(i)),$dispatch(Object(f.E)(l))}},Z=Object(b.D)(A,_,S.a.showMusicNumberPerTime,G);Object(b.o)(Z,o);const X=e===S.a.musicOriginal.musicDownloading;return r.a.createElement(c.Fragment,null,r.a.createElement("div",{className:"music-list-container",ref:Q},Z.map((c,u)=>r.a.createElement("div",{className:"music-list",key:c.filenameOrigin,id:c.filenameOrigin.split(".")[0].match(/\w/g).join("")},r.a.createElement("div",{className:"music-content",onClick:()=>Object(b.p)({filePath:c.filePath,filename:c.filename,filenameOrigin:c.filenameOrigin,uploadUsername:c.uploadUsername,fileSize:c.fileSize,duration:c.duration,songOriginal:c.original,original:e,musicDataList:A,pageType:o,payPlay:Number(c.payPlay),musicId:c.id,songInfo:c})},r.a.createElement("div",{className:`num ${Object(O.d)(u+1)}`},u+1),r.a.createElement("div",{className:"music-info"},r.a.createElement("div",{className:`info ${c.saved&&o!==S.a.musicOriginal.savedSongs?"song-saved":""}`},r.a.createElement("div",{className:`filename ${X?c.saved?"downloading-save":"downloading":""}`,dangerouslySetInnerHTML:{__html:Object(b.t)(c.filename)}}),Number(c.payPlay)?r.a.createElement("i",{className:"fa fa-lock copyright-song-flag","aria-hidden":"true"}):"",c.saved&&o!==S.a.musicOriginal.savedSongs&&r.a.createElement("i",{className:"fa fa-heart saved-song-flag","aria-hidden":"true"}),(e===S.a.musicOriginal.savedSongs||e===S.a.musicOriginal.musicFinished||e===S.a.musicOriginal.musicRecent||e===S.a.musicOriginal.musicDownloading)&&(c.original===S.a.musicOriginal.netEaseCloud?r.a.createElement("div",{className:"net-ease-source-flag"},"网易云"):c.original===S.a.musicOriginal.qqMusic?r.a.createElement("div",{className:"qq-music-source-flag"},"QQ音乐"):c.original===S.a.musicOriginal.kuGouMusic?r.a.createElement("div",{className:"ku-gou-music-source-flag"},"酷狗音乐"):c.original===S.a.musicOriginal.kuWoMusic?r.a.createElement("div",{className:"ku-wo-music-source-flag"},"酷我音乐"):null),c.mvId?r.a.createElement("i",{className:"fa fa-youtube-play","aria-hidden":"true",onClick:e=>((e,a,t,i)=>{e.stopPropagation(),I.push({pathname:"/music_mv_Player",query:{mvId:a,original:t,filename:Object(b.O)(i),lastLocation:getRoute()}})})(e,c.mvId,c.original,c.filename)}):null,X?r.a.createElement("div",{className:"song-duration-time downloading"},c.progress):null),t===c.filenameOrigin?((e,a,t)=>r.a.createElement("div",{className:"audio-player"},r.a.createElement("audio",{preload:"auto",className:"audio-selector"},r.a.createElement("source",{src:e})),r.a.createElement("div",{className:"audio-player-time audio-player-time-current"},Object(b.X)(a)),r.a.createElement("div",{className:"audio-player-bar"},r.a.createElement("div",{className:"audio-player-bar-loaded",style:{width:"100%"}}),r.a.createElement("div",{className:"audio-player-bar-played",style:{width:a/t*100+"%"}})),r.a.createElement("div",{className:"audio-player-time audio-player-time-duration"},Object(b.X)(t))))(c.filePath,i,c.duration):r.a.createElement("div",{className:"upload-duration"},r.a.createElement("div",{className:`upload-user ${X?"downloading":""}`},c.uploadUsername||"未知",(a=>a?e!==S.a.musicOriginal.musicDownloading?("number"==typeof a&&(a=new Date(a).format("yyyy-MM-dd")),e===S.a.musicOriginal.musicShare||e===S.a.musicOriginal.musicSearch||e===S.a.musicOriginal.musicFinished?" "+a.split(" ")[0]:""):void 0:"")(c.date)),X?r.a.createElement("div",{className:"download-progress"},r.a.createElement(l.a,{percent:c.received?c.received/c.fileSize*100:0,position:"normal"})):r.a.createElement("div",{className:`song-duration-time ${Object(O.d)(u+1)}`},Object(b.X)(c.duration)))),!s&&e!==S.a.musicOriginal.musicDownloading&&t===c.filenameOrigin&&r.a.createElement("div",{className:"pause-button-overlay"},r.a.createElement("div",{className:"pause-button"},r.a.createElement("div",{className:"triangle"})))),e!==S.a.musicOriginal.musicDownloading?r.a.createElement("div",{className:"menu",onClick:((i,l,c,u,d,h,M,C,F,L,q,D)=>{document.removeEventListener("backbutton",O.r,!1),document.addEventListener("deviceready",z),i=Object(b.O)(i);const K=JSON.parse(JSON.stringify(w)),T=N.map(e=>Object(b.N)(e.filenameOrigin)),Q=["播放",-1!==T.indexOf(Object(b.N)(c))?"已收藏":"收藏","单曲播放","单曲循环","顺序播放","随机播放","下载","删除","取消"];s&&c===t&&(Q[0]="暂停"),L=e===S.a.musicOriginal.musicShare||e===S.a.musicOriginal.musicSearch?` ${L}`:"";const W={options:Q,cancelButtonIndex:Q.length-1,destructiveButtonIndex:Q.length-2,badges:K,message:l?`大小: ${Object(b.c)(l)}${L}`:L,title:i,maskClosable:!0,"data-seed":"logId",wrapProps:j};e===S.a.musicOriginal.musicFinished?(Q.splice(6,1),W.destructiveButtonIndex=Q.length-2):(C&&K.push({index:6,text:"版"}),o!==S.a.musicOriginal.savedSongs&&"onlineMusic"!==o&&"onlineMusicSearchALl"!==o&&o!==S.a.musicOriginal.homeRecommend||(Q.splice(7,1),delete W.destructiveButtonIndex)),n.a.showActionSheetWithOptions(W,s=>{logger.info("music player showMenu buttonIndex",s);const n=A.map(e=>e.filenameOrigin),j=n.indexOf(c);if(-1===j)return logger.error("showActionSheetWithOptions currentFileIndex === -1 filename",i),alert(i+"已被删除");const w=A[j].filePath;switch(s){case 0:Object(b.p)({filePath:w,filename:i,filenameOrigin:c,uploadUsername:u,fileSize:l,duration:d,songOriginal:h,original:e,musicDataList:A,pageType:o,payPlay:M,musicId:F,songInfo:D});break;case 1:Object(b.V)({savedMusicFilenameOriginalArr:T,filenameOrigin:c,musicCollection:N,musicDataList:A,currentFileIndex:j,original:e,e:null,pageType:o});break;case 2:(!E||y||R)&&(a&&a.loop(!1),$dispatch(Object(f.Y)(!0)),$dispatch(Object(f.Z)(!1)),$dispatch(Object(f.ab)(!1)),alert("单曲播放"),$dispatch(Object(f.K)([{index:2,text:"✔️"},{index:3,text:""},{index:4,text:""},{index:5,text:""}])));break;case 3:E&&(a&&a.loop(!0),$dispatch(Object(f.Y)(!1)),$dispatch(Object(f.Z)(!1)),$dispatch(Object(f.ab)(!1)),alert("单曲循环"),$dispatch(Object(f.K)([{index:2,text:""},{index:3,text:"✔️"},{index:4,text:""},{index:5,text:""}])));break;case 4:y||(a&&a.loop(!1),$dispatch(Object(f.Y)(!0)),$dispatch(Object(f.Z)(!0)),$dispatch(Object(f.ab)(!1)),alert("顺序播放"),$dispatch(Object(f.K)([{index:2,text:""},{index:3,text:""},{index:4,text:"✔️"},{index:5,text:""}])));break;case 5:R||(a&&a.loop(!1),$dispatch(Object(f.Y)(!0)),$dispatch(Object(f.Z)(!1)),$dispatch(Object(f.ab)(!0)),alert("随机播放"),$dispatch(Object(f.K)([{index:2,text:""},{index:3,text:""},{index:4,text:""},{index:5,text:"✔️"}])));break;case 6:if(e===S.a.musicOriginal.musicFinished)V(i,c,t,j,n,e,A);else{const e=w;Object(b.U)({musicDataList:A,filename:i,uploadUsername:u,fileSize:l,musicSrc:e,filenameOrigin:c,duration:d,songOriginal:h,musicId:F,payDownload:C,mvId:D.mvId})}break;case 7:{if(U(),o===S.a.musicOriginal.savedSongs||"onlineMusic"===o||"onlineMusicSearchALl"===o||e===S.a.musicOriginal.musicFinished)return;if(!k)return goRoute(void 0,"/login");const a={username:$||x,token:k,filename:i,type:"default-music"};return void(e!==S.a.musicOriginal.musicShare&&e!==S.a.musicOriginal.musicSearch||"downloaded"===q?e===S.a.musicOriginal.musicRecent?Object(O.j)("提示",r.a.createElement(g.a,{textFragment:`确定要删除 <span class="delete-alert">${i}</span> 的播放记录吗`}),"确定",()=>{let a=null;if(P.some((e,t)=>e.filenameOrigin===c&&(a=t,!0)),null!==a){const i=JSON.parse(JSON.stringify(P));if(i.splice(a,1),$dispatch(Object(f.bb)(i)),Object(v.c)(c),c===t){const a=JSON.parse(JSON.stringify(P));Object(b.r)(j,n,e,a)}}else logger.error("确定要删除播放记录吗 filenameOrigin, recentMusicList",c,P)}):"downloaded"===q&&V(i,c,t,j,n,e,A):Object(O.j)("提示",r.a.createElement(g.a,{textFragment:`确定要从服务器删除 <span class="delete-alert">${i}</span> 吗`}),"确定",()=>(Object(O.A)(),axios.delete(m.a.delFile,{data:a}).then(a=>{if(window.toast.hide(),!window.cancelAxiosRequest)return"success"===a.data.result.result?($dispatch(Object(p.j)(a.data.result.token)),alert("删除成功"),Y(e,c)):"file_deleted"===a.data.result.result?(alert("文件已删除!"),Y(e,c)):void logger.error("HTTP_URL.delFile result",a)}).then(()=>{c===t&&Object(b.r)(j,n,e,A)}).catch(e=>{logger.error("HTTP_URL.delFile err",e),Object(O.q)(e,`musicPlayer delFile filenameOrigin: ${c}`)}).finally(()=>{window.cancelAxiosRequest=!1}))))}}U()})}).bind(void 0,c.filename,c.fileSize,c.filenameOrigin,c.uploadUsername,c.duration,c.original,Number(c.payPlay),Number(c.payDownload),c.id,c.date,c.status,c)},r.a.createElement("div",{className:"dot"}),r.a.createElement("div",{className:"dot"}),r.a.createElement("div",{className:"dot"})):r.a.createElement("div",{className:"move-downloading-item fa fa-remove",onClick:((e,a)=>{Object(O.j)("提示",r.a.createElement(g.a,{textFragment:`确定要移除下载 <span class="delete-alert">${e}</span> 吗`}),"确定",()=>{const e=Object(b.N)(a);window.eventEmit.$emit(`FileTransfer-${e}`,"abort"),window[`remove-download-${e}`]=!0,setTimeout(()=>{},500);const{downloadingMusicItems:t}=$getState().fileServer,i=JSON.parse(JSON.stringify(t));for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].filenameOrigin===a){i.splice(e,1),$dispatch(Object(f.n)(i)),Object(M.c)(a);break}logger.info("saveFileToLocal param, downloadingMusicItems",t)})}).bind(void 0,c.filename,c.filenameOrigin)}))),T&&!W?r.a.createElement("div",{className:"bottom-text"},"我是有底线的"):null),o===S.a.musicOriginal.savedSongs&&r.a.createElement("div",{className:"music-picture"}),!L&&!K&&r.a.createElement(h.default,{fromMusicControl:!0,myMusicPage:q,searchMusicPage:D}))})},238:function(e,a,t){"use strict";t(222);var i=t(223),l=t.n(i),s=(t(219),t(220)),n=t.n(s),c=t(0),r=t.n(c),o=t(3),u=t(71),d=t(259),m=t.n(d),h=t(51),g=t(4),f=t(10),O=t(6),p=t(11),b=t(8),S=t(1),v=t(22);function M(e){return function(){var a=e.apply(this,arguments);return new Promise(function(e,t){return function i(l,s){try{var n=a[l](s),c=n.value}catch(e){return void t(e)}if(!n.done)return Promise.resolve(c).then(function(e){i("next",e)},function(e){i("throw",e)});e(c)}("next")})}}let j;new RegExp("\\biPhone\\b|\\biPod\\b","i").test(navigator.userAgent)&&(j={onTouchStart:e=>e.preventDefault()});a.a=Object(u.connect)(e=>({username:e.login.username,token:e.login.token,downloadingFileList:e.fileServer.downloadingFileList,lastFileSearchResult:e.fileServer.lastFileSearchResult,lastSearchAllFileResult:e.fileServer.lastSearchAllFileResult,setMobile:e.myInfo.setMobile,downloadedFileList:e.fileServer.downloadedFileList}),()=>({}))(({username:e,token:a,downloadingFileList:t,downloadedFileList:i,lastFileSearchResult:s,lastSearchAllFileResult:u,setMobile:d,fileDataList:E=[],original:y})=>{const N=Object(o.useHistory)(),[w,$]=Object(c.useState)(!0),k=()=>{window.cancelMenuFirst=!0,document.addEventListener("backbutton",R,!1)},R=()=>{window.cancelMenuFirst=!1;const e=document.querySelector(".am-action-sheet-button-list div:nth-last-child(1)");e&&e.click(),e&&e.click()},x=(()=>{var e=M(function*(e,a,t,l,s,c,o){try{document.removeEventListener("backbutton",g.r,!1),document.addEventListener("deviceready",k),e=Object(b.O)(e);let u="下载",d="fileFinished"===y;d?u="打开":"fileShare"!==y&&"fileSearch"!==y||i.some(function(e){return!(Object(b.N)(e.filenameOrigin)!==Object(b.N)(s)||e.status&&"downloaded"!==e.status||(u="打开",d=!0,0))});const m=[u,"分享","删除","取消"];"fileDownloading"===y||"fileFinished"===y||"downloaded"===o?(m.splice(1,1),c=""):"fileShare"===y&&(c=` ${c}`),isCordova||"fileShare"!==y&&"fileSearch"!==y||m.splice(1,1);const f={options:m,cancelButtonIndex:m.length-1,destructiveButtonIndex:m.length-2,message:`大小: ${Object(b.c)(a)}${c}`,title:e,maskClosable:!0,"data-seed":"logId",wrapProps:j};n.a.showActionSheetWithOptions(f,function(i){switch(logger.info("file manage showMenu buttonIndex",i),i){case 0:d?F(e,s):Object(b.T)(e,l,a,t,!1,s,N,F);break;case 1:if("fileFinished"===y||"downloaded"===o)Object(g.j)("提示",r.a.createElement(h.a,{textFragment:`确定从本地删除 <span class="delete-alert">${e}</span> 吗`}),"确定",function(){Object(b.M)(Object(b.N)(s),"file").then(function(){C(y,s)}).catch(function(a){logger.error("删除文件过程中发生了错误 isFileFinished",a.stack||a.toString()),Object(g.q)(a,`fileManage removeFileFromDownload filename ${e}`)})});else if(isCordova){const i=`${O.a.appStaticDirectory}#/show_file_info?filename=${e}&fileSize=${Object(b.c)(a)}&filePath=${t}`;Object(g.w)({title:e,description:"我分享了一个文件,快来看看吧",thumb:`${O.a.appStaticDirectory}logo.png`,webpageUrl:i})}else A(e,s);break;case 2:!isCordova||"fileShare"!==y&&"fileSearch"!==y||"downloaded"===o||A(e,s);break;default:logger.warn("buttonIndex default")}window.cancelMenuFirst=!1,document.removeEventListener("backbutton",R),document.removeEventListener("deviceready",k),document.addEventListener("backbutton",g.r,!1)})}catch(e){logger.error("fileManage showMenu err",e)}});return function(a,t,i,l,s,n,c){return e.apply(this,arguments)}})(),A=(t,i)=>{if(!a)return goRoute(void 0,"/login");const l={username:e||d,token:a,filename:t,type:"default-file"};Object(g.j)("提示",r.a.createElement(h.a,{textFragment:`确定从服务器删除 <span class="delete-alert">${t}</span> 吗`}),"确定",()=>(Object(g.A)(),axios.delete(f.a.delFile,{data:l}).then(e=>{if(window.toast.hide(),!window.cancelAxiosRequest)return"file_deleted"===e.data.result.result?(alert("文件已删除!"),$dispatch(Object(p.j)(e.data.result.token)),C(y,i)):"success"===e.data.result.result?(alert("删除成功!"),$dispatch(Object(p.j)(e.data.result.token)),C(y,i)):void alert("删除失败!")}).catch(e=>{logger.error("删除文件过程中发生了错误",e.stack||e.toString()),Object(g.q)(e,`delFile dataInfo: ${JSON.stringify(l)}`)}).finally(()=>{window.cancelAxiosRequest=!1})))},C=(e,a)=>{if("fileSearch"===e){let e,t;s.some((t,i)=>t.filenameOrigin===a&&(e=i,!0));const i=JSON.parse(JSON.stringify(s));i.splice(e,1),u.some((e,i)=>e.filenameOrigin===a&&(t=i,!0));const l=JSON.parse(JSON.stringify(u));u.splice(t,1),$dispatch(Object(S.s)(i)),$dispatch(Object(S.B)(l))}},F=(e,a)=>{let t=m.a.lookup(e);t||(t="text/plain",alert("不支持打开的的文件类型，请提交反馈")),Object(b.C)(e,t,Object(b.N)(a))},P=(()=>{var e=M(function*(e,a,i,l,s){e=Object(b.O)(e),"fileFinished"===y?F(e,s):"fileShare"===y||"fileSearch"===y?yield Object(b.T)(e,a,i,l,!1,s,N,F):"fileDownloading"===y&&t.some(function(t){return t.filenameOrigin===s&&(s=s.replace(/^downloading_/,""),logger.info("downloadOrOpenFile filenameOrigin",s),"失败"===t.progress||"已取消"===t.progress?Object(b.T)(e,a,i,l,!0,s,N,F):(window.eventEmit.$emit(`FileTransfer-${s}`,"abort"),setTimeout(function(){window[`cancel-download-${Object(b.N)(s)}`]||Object(b.T)(e,a,i,l,!0,s,N,F)},500)),!0)})});return function(a,t,i,l,s){return e.apply(this,arguments)}})(),L=Object(b.D)(E,w,O.a.showFileNumberPerTime,$),q="fileDownloading"===y;return r.a.createElement("div",{className:"file-manage-container"},L.map((e,a)=>r.a.createElement("div",{className:"file-list",key:e.filenameOrigin},r.a.createElement("div",{className:`file-content ${q?"downloading":""}`,onClick:P.bind(void 0,e.filename,e.uploadUsername,e.fileSize,e.filePath,e.filenameOrigin)},r.a.createElement("div",{className:`num ${Object(g.d)(a+1)}`},a+1),r.a.createElement("div",{className:"file-info"},r.a.createElement("div",{className:`info ${"fileFinished"===y?"center":""} ${e.downloaded?"downloaded":""}`},r.a.createElement("div",{className:`filename ${q?"downloading":""}`,dangerouslySetInnerHTML:{__html:e.filename}}),e.downloaded&&r.a.createElement("div",{className:"downloaded-text"},"已下载"),q?r.a.createElement("div",{className:"file-size downloading"},e.progress):null),r.a.createElement("div",{className:"upload-info"},r.a.createElement("div",{className:`upload-user ${q?"downloading":""}`},`${"fileFinished"!==y?e.uploadUsername:""}${(e=>e?"fileDownloading"===y?"":("number"==typeof e&&(e=new Date(e).format("yyyy-MM-dd"))," "+e.split(" ")[0]):"")(e.date)}`),"fileShare"===y||"fileSearch"===y?r.a.createElement("div",{className:`file-size ${Object(g.d)(a+1)}`},Object(b.c)(e.fileSize)):q?r.a.createElement("div",{className:"download-progress"},r.a.createElement(l.a,{percent:e.received?e.received/e.fileSize*100:0,position:"normal"})):null))),q?r.a.createElement("div",{className:"move-downloading-item fa fa-remove",onClick:((e,a)=>{Object(g.j)("提示",r.a.createElement(h.a,{textFragment:`确定要移除下载 <span class="delete-alert">${e}</span> 吗`}),"确定",()=>{const e=Object(b.N)(a);window.eventEmit.$emit(`FileTransfer-${e}`,"abort"),window[`remove-download-${e}`]=!0,setTimeout(()=>{},500);const{downloadingFileList:t}=$getState().fileServer,i=JSON.parse(JSON.stringify(t));for(const e in t)if(i[e].filenameOrigin===a){i.splice(e,1),$dispatch(Object(S.m)(i)),Object(v.c)(a);break}})}).bind(void 0,e.filename,e.filenameOrigin)}):r.a.createElement("div",{className:"menu",onClick:x.bind(void 0,e.filename,e.fileSize,e.filePath,e.uploadUsername,e.filenameOrigin,e.date,e.status)},r.a.createElement("div",{className:"dot"}),r.a.createElement("div",{className:"dot"}),r.a.createElement("div",{className:"dot"})))))})},243:function(e,a,t){"use strict";var i=t(0),l=t.n(i),s=t(71),n=t(204),c=t(208),r=t(238),o=t(228),u=t(10),d=t(1),m=t(4),h=t(6),g=t(8);let f="",O=null;a.a=Object(s.connect)(e=>({noMoreNetEaseCloudResults:e.fileServer.noMoreNetEaseCloudResults,noMoreQQMusicResults:e.fileServer.noMoreQQMusicResults,noMoreKuGouMusicResults:e.fileServer.noMoreKuGouMusicResults,noMoreKuWoMusicResults:e.fileServer.noMoreKuWoMusicResults,noMoreSearchAllFileResults:e.fileServer.noMoreSearchAllFileResults,noMoreSearchAllMusicResults:e.fileServer.noMoreSearchAllMusicResults,noMoreSearchAllNetEaseCloudResults:e.fileServer.noMoreSearchAllNetEaseCloudResults,noMoreSearchAllQQMusicResults:e.fileServer.noMoreSearchAllQQMusicResults,noMoreSearchAllKuGouMusicResults:e.fileServer.noMoreSearchAllKuGouMusicResults,noMoreSearchAllKuWoMusicResults:e.fileServer.noMoreSearchAllKuWoMusicResults,musicCollection:e.fileServer.musicCollection,downloadedMusicList:e.fileServer.downloadedMusicList,downloadedFileList:e.fileServer.downloadedFileList,defaultSearchRealKey:e.common.defaultSearchRealKey}),()=>({}))(({lastSearchResult:e,lastSearchString:a,type:t,musicCollection:s,fileDatalist:p,musicDatalist:b,navbarText:S,placeholder:v,noMoreNetEaseCloudResults:M,noMoreQQMusicResults:j,noMoreKuGouMusicResults:E,noMoreKuWoMusicResults:y,noMoreSearchAllFileResults:N,noMoreSearchAllMusicResults:w,noMoreSearchAllNetEaseCloudResults:$,noMoreSearchAllQQMusicResults:k,noMoreSearchAllKuGouMusicResults:R,noMoreSearchAllKuWoMusicResults:x,downloadedMusicList:A,downloadedFileList:C,currentQueryStringWithResults:F,defaultSearchRealKey:P})=>{const[L,q]=Object(i.useState)(!1),[D,K]=Object(i.useState)(!1),[T,Q]=Object(i.useState)(!1),[W,I]=Object(i.useState)(!1),[_,G]=Object(i.useState)(!1),[J,B]=Object(i.useState)(!1),[z,U]=Object(i.useState)(!1),[H,V]=Object(i.useState)(!1),Y=Object(i.useRef)();Object(i.useEffect)(()=>{K(!!e.length),!a&&Y.current&&Y.current.focus()},[]);const Z=e=>"searchAll"===t?`searchAll_${e.filenameOrigin?e.filenameOrigin:e.filename+"_"+e.md5+".mp3"}`:"onlineMusic"===t?"onlineMusic_"+e.filename+"_"+e.md5+".mp3":"music"===t?"searchMusic_"+e.filenameOrigin:void 0,X=(e,a,t)=>{switch(a=JSON.parse(JSON.stringify(a)),"file"!==e&&"fileSearchAll"!==e&&a.forEach(e=>{e.filenameOrigin=Z(e),(e=>{s.forEach(a=>{Object(g.N)(a.filenameOrigin)===Object(g.N)(e.filenameOrigin)&&(e.saved=!0)})})(e)}),a.forEach(a=>{let i=a.filename;i="file"===e||"music"===e?(i=i.split(f)).join(`<span class="hight-light-keyword">${f}</span>`):(i=i.split(t||F||f)).join(`<span class="hight-light-keyword">${t||F||f}</span>`),a.filename=i}),e){case"file":$dispatch(Object(d.s)(a));break;case"music":$dispatch(Object(d.w)(a));break;case h.a.musicOriginal.netEaseCloud:$dispatch(Object(d.y)(a));break;case h.a.musicOriginal.qqMusic:$dispatch(Object(d.A)(a));break;case h.a.musicOriginal.kuGouMusic:$dispatch(Object(d.u)(a));break;case h.a.musicOriginal.kuWoMusic:$dispatch(Object(d.v)(a));break;case"onlineMusic":$dispatch(Object(d.y)([])),$dispatch(Object(d.A)([])),$dispatch(Object(d.u)([])),$dispatch(Object(d.v)([]));break;case"searchAll":$dispatch(Object(d.B)([])),$dispatch(Object(d.E)([])),$dispatch(Object(d.F)([])),$dispatch(Object(d.G)([])),$dispatch(Object(d.C)([])),$dispatch(Object(d.D)([]));break;case"netEaseCloudSearchAll":$dispatch(Object(d.F)(a));break;case"qqMusicSearchAll":$dispatch(Object(d.G)(a));break;case"kuGouMusicSearchAll":$dispatch(Object(d.C)(a));break;case"kuWoMusicSearchAll":$dispatch(Object(d.D)(a));break;case"fileSearchAll":$dispatch(Object(d.B)(a));break;case"musicSearchAll":$dispatch(Object(d.E)(a))}},ee=(e,a)=>{switch(f=a,e){case"file":$dispatch(Object(d.t)(a));break;case"music":$dispatch(Object(d.x)(a));break;case"onlineMusic":$dispatch(Object(d.z)(a));break;case"searchAll":$dispatch(Object(d.H)(a))}},ae=e=>{try{K(!1);const a=e?e.target.value:"";if(ee(t,a),!a)return Q(!1),I(!1),G(!1),B(!1),U(!1),V(!1),void(O&&clearInterval(O));"music"===t||"file"===t?te(a):(O&&clearInterval(O),O=setTimeout(()=>{te(a),O=null},800))}catch(e){logger.error("SearchResourceComponent updateValue type",t,"err",e),alertDebug("SearchResourceComponent updateValue err")}},te=e=>{if(logger.info("SearchResourceComponent getAutoSuggest query",e),"searchAll"!==t&&"onlineMusic"!==t||!v||"搜索"===v||e||ee(t,e=P),e){if(q(!0),Q(!1),I(!1),G(!1),B(!1),U(!1),V(!1),"onlineMusic"===t)return $dispatch(Object(d.P)(!1)),$dispatch(Object(d.Q)(!1)),$dispatch(Object(d.N)(!1)),$dispatch(Object(d.O)(!1)),le(e,h.a.musicOriginal.netEaseCloud,h.a.musicOriginal.qqMusic,h.a.musicOriginal.kuGouMusic,h.a.musicOriginal.kuWoMusic);if("file"===t||"music"===t)ie(e,t);else if("searchAll"===t)return $dispatch(Object(d.V)(!1)),$dispatch(Object(d.W)(!1)),$dispatch(Object(d.S)(!1)),$dispatch(Object(d.T)(!1)),le(e,"netEaseCloudSearchAll","qqMusicSearchAll","kuGouMusicSearchAll","kuWoMusicSearchAll").then(()=>{ie(e,"fileSearchAll",3),ie(e,"musicSearchAll",3)})}},ie=(e,a,t)=>{if(!e)return;let i=[],l=[];if("file"===a||"fileSearchAll"===a){const e=[...C,...p];l=JSON.parse(JSON.stringify(e))}else if("music"===a||"musicSearchAll"===a){const e=[...A,...b];l=JSON.parse(JSON.stringify(e))}(l=Object.values(Object(g.L)(l))).forEach(a=>{a.filename.includes(e)&&i.push(a)}),t?(i.length<=t?"fileSearchAll"===a?$dispatch(Object(d.R)(!0)):"musicSearchAll"===a&&$dispatch(Object(d.U)(!0)):"fileSearchAll"===a?$dispatch(Object(d.R)(!1)):"musicSearchAll"===a&&$dispatch(Object(d.U)(!1)),i=i.slice(0,t)):"fileSearchAll"===a?$dispatch(Object(d.R)(!0)):"musicSearchAll"===a&&$dispatch(Object(d.U)(!0)),X(a,i,e),q(!1),K(!0)},le=(e,a,i,l,s)=>{if(e)return logger.info("SearchResourceComponent fetchOnlineSongs query",e),axios.get(u.a.getOnlineMusicLists.format({query:e})).then(n=>{const c=n.data.result.response;logger.info("SearchResourceComponent fetchOnlineSongs result"),"onlineMusic"===t?$dispatch(Object(d.i)(e)):"searchAll"===t&&$dispatch(Object(d.h)(e)),q(!1),X(a,c.netEaseCloud,e),X(i,c.qqMusic,e),X(l,c.kuGouMusic,e),X(s,c.kuWoMusic,e),Object(g.A)({msg:"search online music query: "+e})}).catch(a=>(q(!1),Object(m.q)(a,`fetchOnlineSongs ${e}`)))},se=e=>{let t;if(e===h.a.musicOriginal.netEaseCloud||"netEaseCloudSearchAll"===e){if(T||!F)return;t=u.a.getNetEaseCloudMusicLists,Q(!0)}else if(e===h.a.musicOriginal.qqMusic||"qqMusicSearchAll"===e){if(W||!F)return;t=u.a.getQQMusicLists,I(!0)}else if(e===h.a.musicOriginal.kuGouMusic||"kuGouMusicSearchAll"===e){if(_||!F)return;t=u.a.getKuGouMusicLists,G(!0)}else if(e===h.a.musicOriginal.kuWoMusic||"kuWoMusicSearchAll"===e){if(J||!F)return;t=u.a.getKuWoMusicLists,B(!0)}else{if("file"===e){if(z||!a)return;return U(!0),void ie(a,"fileSearchAll")}if("music"===e){if(H||!a)return;return V(!0),void ie(a,"musicSearchAll")}}return logger.info("SearchResourceComponent showMoreSearchResult original, currentQueryStringWithResults",e,F),axios.get(t.format({query:F})).then(a=>{const t=a.data.result.response;logger.info("SearchResourceComponent showMoreSearchResult original, result.length",e,t.length),ne(e,t)}).catch(a=>(ne(e,null),Object(m.q)(a,`showMoreSearchResult axios ${e}`)))},ne=(e,a)=>{e===h.a.musicOriginal.netEaseCloud||"netEaseCloudSearchAll"===e?(a&&X(e,a,null),e===h.a.musicOriginal.netEaseCloud?$dispatch(Object(d.P)(!0)):$dispatch(Object(d.V)(!0)),Q(!1)):e===h.a.musicOriginal.qqMusic||"qqMusicSearchAll"===e?(a&&X(e,a,null),e===h.a.musicOriginal.qqMusic?$dispatch(Object(d.Q)(!0)):$dispatch(Object(d.W)(!0)),I(!1)):e===h.a.musicOriginal.kuGouMusic||"kuGouMusicSearchAll"===e?(a&&X(e,a,null),e===h.a.musicOriginal.kuGouMusic?$dispatch(Object(d.N)(!0)):$dispatch(Object(d.S)(!0)),G(!1)):e!==h.a.musicOriginal.kuWoMusic&&"kuWoMusicSearchAll"!==e||(a&&X(e,a,null),e===h.a.musicOriginal.kuWoMusic?$dispatch(Object(d.O)(!0)):$dispatch(Object(d.T)(!0)),B(!1))},ce=({origin:e,lastSearchResult:a,noMoreNetEaseCloudResults:t,moreNetEaseCloudSearch:s,noMoreQQMusicResults:n,moreQQMusicSearch:c,noMoreKuGouMusicResults:r,moreKuGouMusicSearch:u,noMoreKuWoMusicResults:d,moreKuWoMusicSearch:m})=>l.a.createElement(i.Fragment,null,l.a.createElement("div",{className:"online-music-container"},l.a.createElement("div",{className:"interval-line"}),l.a.createElement("div",{className:"online-music-header"},"QQ音乐"),l.a.createElement(o.a,{musicDataList:a[2].lastQQMusicSearchResult,original:h.a.musicOriginal.qqMusic,pageType:e,searchMusicPage:!0}),l.a.createElement("div",{className:"online-music-more-btn last-one",onClick:()=>se("onlineMusic"===e?h.a.musicOriginal.qqMusic:"qqMusicSearchAll")},!n&&a[2].lastQQMusicSearchResult.length?l.a.createElement("i",{className:`fa fa-search ${c&&"searching-status"}`,"aria-hidden":"true"}):null,c&&!n?l.a.createElement("span",{className:"searching-text"},"正在查询..."):n||!a[2].lastQQMusicSearchResult.length?null:l.a.createElement("span",{className:"more-results-text"},"更多结果"))),l.a.createElement("div",{className:"online-music-container"},l.a.createElement("div",{className:"interval-line first-line"}),l.a.createElement("div",{className:"online-music-header"},"网易云"),l.a.createElement(o.a,{musicDataList:a[3].lastNetEaseCloudSearchResult,original:h.a.musicOriginal.netEaseCloud,pageType:e,noShowMusicPlaying:!0}),l.a.createElement("div",{className:"online-music-more-btn",onClick:()=>se("onlineMusic"===e?h.a.musicOriginal.netEaseCloud:"netEaseCloudSearchAll")},!t&&a[3].lastNetEaseCloudSearchResult.length?l.a.createElement("i",{className:`fa fa-search ${s&&"searching-status"}`,"aria-hidden":"true"}):null,s&&!t?l.a.createElement("span",{className:"searching-text"},"正在查询..."):t||!a[3].lastNetEaseCloudSearchResult.length?null:l.a.createElement("span",{className:"more-results-text"},"更多结果"))),l.a.createElement("div",{className:"online-music-container"},l.a.createElement("div",{className:"interval-line"}),l.a.createElement("div",{className:"online-music-header"},"酷狗音乐"),l.a.createElement(o.a,{musicDataList:a[4].lastKuGouMusicSearchResult,original:h.a.musicOriginal.kuGouMusic,pageType:e,noShowMusicPlaying:!0}),l.a.createElement("div",{className:"online-music-more-btn last-one",onClick:()=>se("onlineMusic"===e?h.a.musicOriginal.kuGouMusic:"kuGouMusicSearchAll")},!r&&a[4].lastKuGouMusicSearchResult.length?l.a.createElement("i",{className:`fa fa-search ${u&&"searching-status"}`,"aria-hidden":"true"}):null,u&&!r?l.a.createElement("span",{className:"searching-text"},"正在查询..."):r||!a[4].lastKuGouMusicSearchResult.length?null:l.a.createElement("span",{className:"more-results-text"},"更多结果"))),l.a.createElement("div",{className:"online-music-container"},l.a.createElement("div",{className:"interval-line"}),l.a.createElement("div",{className:"online-music-header"},"酷我音乐"),l.a.createElement(o.a,{musicDataList:a[5].lastKuWoMusicSearchResult,original:h.a.musicOriginal.kuWoMusic,pageType:e,noShowMusicPlaying:!0}),l.a.createElement("div",{className:"online-music-more-btn last-one",onClick:()=>se("onlineMusic"===e?h.a.musicOriginal.kuWoMusic:"kuWoMusicSearchAll")},!d&&a[5].lastKuWoMusicSearchResult.length?l.a.createElement("i",{className:`fa fa-search ${m&&"searching-status"}`,"aria-hidden":"true"}):null,m&&!d?l.a.createElement("span",{className:"searching-text"},"正在查询..."):d||!a[5].lastKuWoMusicSearchResult.length?null:l.a.createElement("span",{className:"more-results-text"},"更多结果"))));return l.a.createElement("div",{className:"search-component-container"},l.a.createElement(n.a,{centerText:S,backToPreviousPage:()=>Object(m.b)("/search_column",!1)}),l.a.createElement("div",{className:"search-header"},l.a.createElement("div",{className:"search-input"},l.a.createElement(c.a,{value:a,placeholder:v,handleChange:ae,handleKeyDown:e=>{13===e.keyCode&&(logger.info("lastSearchString",a),Y.current.blur(),te(a))},className:"search-input-content",ref:Y}),l.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"}),a&&l.a.createElement("i",{className:"fa fa-times-circle-o","aria-hidden":"true",onClick:ae}))),l.a.createElement("div",{className:`search-result-container ${"file"===t&&"isFileSearchColumn"}`},L?l.a.createElement("div",{className:"searching"},"正在查询..."):e.length||!a?l.a.createElement("div",{className:"search-result-content"},"file"===t?l.a.createElement(r.a,{fileDataList:e,original:"fileSearch",type:"file"}):"music"===t?l.a.createElement(o.a,{musicDataList:e,original:h.a.musicOriginal.musicSearch,pageType:"onlySearchShareMusic",searchMusicPage:!0}):"onlineMusic"===t?ce({origin:"onlineMusic",lastSearchResult:e,noMoreNetEaseCloudResults:M,moreNetEaseCloudSearch:T,noMoreQQMusicResults:j,moreQQMusicSearch:W,noMoreKuGouMusicResults:E,moreKuGouMusicSearch:_,noMoreKuWoMusicResults:y,moreKuWoMusicSearch:J}):"searchAll"===t?l.a.createElement(i.Fragment,null,l.a.createElement("div",{className:"online-music-container"},l.a.createElement("div",{className:"online-music-header"},"文件"),l.a.createElement(r.a,{fileDataList:e[0].lastSearchAllFileResult,original:"fileSearch",type:"searchAll"}),l.a.createElement("div",{className:"online-music-more-btn last-one",onClick:()=>se("file")},!N&&e[0].lastSearchAllFileResult.length?l.a.createElement("i",{className:`fa fa-search ${z&&"searching-status"}`,"aria-hidden":"true"}):null,z&&!N?l.a.createElement("span",{className:"searching-text"},"正在查询..."):N||!e[0].lastSearchAllFileResult.length?null:l.a.createElement("span",{className:"more-results-text"},"更多结果"))),l.a.createElement("div",{className:"online-music-container"},l.a.createElement("div",{className:"interval-line"}),l.a.createElement("div",{className:"online-music-header"},"音乐"),l.a.createElement(o.a,{musicDataList:e[1].lastSearchAllMusicResult,original:h.a.musicOriginal.musicSearch,pageType:"onlineMusicSearchALl",noShowMusicPlaying:!0}),l.a.createElement("div",{className:"online-music-more-btn last-one",onClick:()=>se("music")},!w&&e[1].lastSearchAllMusicResult.length?l.a.createElement("i",{className:`fa fa-search ${H&&"searching-status"}`,"aria-hidden":"true"}):null,H&&!w?l.a.createElement("span",{className:"searching-text"},"正在查询..."):w||!e[1].lastSearchAllMusicResult.length?null:l.a.createElement("span",{className:"more-results-text"},"更多结果"))),ce({origin:"onlineMusicSearchALl",lastSearchResult:e,noMoreNetEaseCloudResults:$,moreNetEaseCloudSearch:T,noMoreQQMusicResults:k,moreQQMusicSearch:W,noMoreKuGouMusicResults:R,moreKuGouMusicSearch:_,noMoreKuWoMusicResults:x,moreKuWoMusicSearch:J})):null):D&&l.a.createElement("div",{className:"no-result"},"没有结果")))})}}]);