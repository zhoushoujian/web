(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{139:function(e,t,a){"use strict";var n=a(0),i=a.n(n);var r=()=>i.a.createElement("div",{className:"top-status-bar"});t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:s=(()=>{})})=>i.a.createElement(n.Fragment,null,i.a.createElement(r,null),i.a.createElement("div",{className:"navbar-container"},i.a.createElement("div",{className:"back-btn",onClick:t},i.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),i.a.createElement("div",{className:"center-text"},e),i.a.createElement("div",{className:"other-text",onClick:s},a))))},266:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(12),s=a(2),c=a(139);var l=()=>i.a.createElement("svg",{className:"like-btn",width:"56px",height:"56px",viewBox:"0 0 56 56",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",null,i.a.createElement("rect",{fillRule:"nonzero",x:"0",y:"0",width:"56",height:"56",rx:"28"}),i.a.createElement("g",{transform:"translate(27.000000, 5.000000)",fillRule:"nonzero",stroke:"#FD5F66",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"},i.a.createElement("path",{d:"M1,0 L1,5",id:"path-3"}),i.a.createElement("path",{d:"M1.5,41 L1.5,46",id:"path-2"})),i.a.createElement("g",{transform:"translate(28.000000, 28.000000) rotate(60.000000) translate(-28.000000, -28.000000) translate(27.000000, 5.000000)",fillRule:"nonzero",stroke:"#FD5F66",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"},i.a.createElement("path",{d:"M1,-2.27373675e-13 L1,5",id:"path-3"}),i.a.createElement("path",{d:"M1.5,41 L1.5,46",id:"path-2"})),i.a.createElement("path",{id:"fill-3",fill:"#7D878F",fillRule:"nonzero",d:"M28.153959,20.8677974 L28.3060347,20.7157217 C30.5936636,18.4280928 34.3036142,18.4280928 36.5912431,20.7157217 L35.8841363,21.4228284 L36.5912431,20.7157217 C38.878872,23.0033505 38.878872,26.7133011 36.5912431,29.00093 L28.153959,37.4382141 L20.5758574,29.8601125 L19.7169046,29.0011596 C17.4277368,26.7134783 17.4277368,23.0031734 19.7166749,20.7157217 C22.0043038,18.4280928 25.7142544,18.4280928 28.0018832,20.7157217 L28.153959,20.8677974 Z M35.8841363,21.4228284 L35.1770295,22.1299352 C33.6704492,20.6233549 31.2268286,20.6233549 29.7202483,22.1299352 L28.153959,23.6962245 L26.5876697,22.1299352 C25.0810894,20.6233549 22.6374687,20.6233549 21.1306588,22.1301648 C19.623152,23.6366927 19.623152,26.079959 21.1308885,27.5867165 L28.153959,34.609787 L35.1770295,27.5867165 C36.6836098,26.0801362 36.6836098,23.6365155 35.1770295,22.1299352 L35.8841363,21.4228284 Z"}),i.a.createElement("path",{id:"heart-color",d:"M28.153959,20.8677974 L28.3060347,20.7157217 C30.5936636,18.4280928 34.3036142,18.4280928 36.5912431,20.7157217 L35.8841363,21.4228284 L36.5912431,20.7157217 C38.878872,23.0033505 38.878872,26.7133011 36.5912431,29.00093 L28.153959,37.4382141 L20.5758574,29.8601125 L19.7169046,29.0011596 C17.4277368,26.7134783 17.4277368,23.0031734 19.7166749,20.7157217 C22.0043038,18.4280928 25.7142544,18.4280928 28.0018832,20.7157217 L28.153959,20.8677974 Z"}),i.a.createElement("g",{transform:"translate(28.000000, 28.000000) rotate(120.000000) translate(-28.000000, -28.000000) translate(27.000000, 5.000000)",fillRule:"nonzero",stroke:"#FD5F66",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"},i.a.createElement("path",{d:"M1,4.54747351e-13 L1,5",id:"path-3"}),i.a.createElement("path",{d:"M1.5,41 L1.5,46",id:"path-2"}))))),o=a(115),m=a(19),d=a(94);var u=()=>i.a.createElement("div",{className:"eevee"},i.a.createElement("div",{className:"body"},i.a.createElement("div",{className:"head"},i.a.createElement("div",{className:"ears"},i.a.createElement("div",{className:"ear"},i.a.createElement("div",{className:"lobe"})),i.a.createElement("div",{className:"ear"},i.a.createElement("div",{className:"lobe"}))),i.a.createElement("div",{className:"face"},i.a.createElement("div",{className:"eyes"},i.a.createElement("div",{className:"eye"},i.a.createElement("div",{className:"eyelid"})),i.a.createElement("div",{className:"eye"},i.a.createElement("div",{className:"eyelid"}))),i.a.createElement("div",{className:"nose"}),i.a.createElement("div",{className:"mouth"}))),i.a.createElement("div",{className:"chest"},i.a.createElement("div",{className:"fur"},i.a.createElement("div",{className:"patch"})),i.a.createElement("div",{className:"fur"},i.a.createElement("div",{className:"patch"})),i.a.createElement("div",{className:"fur"},i.a.createElement("div",{className:"patch"}))),i.a.createElement("div",{className:"legs"},i.a.createElement("div",{className:"leg"},i.a.createElement("div",{className:"inner-leg"})),i.a.createElement("div",{className:"leg"},i.a.createElement("div",{className:"inner-leg"})),i.a.createElement("div",{className:"leg"},i.a.createElement("div",{className:"inner-leg"})),i.a.createElement("div",{className:"leg"},i.a.createElement("div",{className:"inner-leg"}))),i.a.createElement("div",{className:"tail"},i.a.createElement("div",{className:"tail"},i.a.createElement("div",{className:"tail"},i.a.createElement("div",{className:"tail"},i.a.createElement("div",{className:"tail"},i.a.createElement("div",{className:"tail -end"})))))))),v=a(93);a(66);t.default=Object(r.b)(e=>({soundPlaying:e.fileServer.soundPlaying,soundInstance:e.fileServer.soundInstance,soundInstanceId:e.fileServer.soundInstanceId,currentPlayingSong:e.fileServer.currentPlayingSong,musicCollection:e.fileServer.musicCollection,currentPlayingSongOriginal:e.fileServer.currentPlayingSongOriginal,currentPlayingMusicList:e.fileServer.currentPlayingMusicList,musicPageType:e.fileServer.musicPageType,currentSongTime:e.fileServer.currentSongTime,isHeadPhoneView:e.fileServer.isHeadPhoneView,currentMusicItemInfo:e.fileServer.currentMusicItemInfo,showMusicPlayingFromMusicControl:e.fileServer.showMusicPlayingFromMusicControl,currentPlayingMusicLyric:e.fileServer.currentPlayingMusicLyric,isLyricView:e.fileServer.isLyricView}),()=>({}))(({currentPlayingSong:e,currentPlayingMusicList:t=[],musicCollection:a=[],currentPlayingSongOriginal:r,soundPlaying:g,musicPageType:f,currentSongTime:h,isHeadPhoneView:p,isLyricView:E,soundInstance:b,soundInstanceId:y,currentMusicItemInfo:w,fromMusicControl:N,showMusicPlayingFromMusicControl:L,currentPlayingMusicLyric:O})=>{const j={debounceTimer:null,firstTimeRun:!1},[S,k]=Object(n.useState)(!1),[P,C]=Object(n.useState)(!1),[M,$]=Object(n.useState)(!1),[x,F]=Object(n.useState)(["暂无歌词"]),I=window.innerWidth,T=window.innerHeight,_=Object(s.f)(),R=Object(n.useRef)(),D=Object(n.useRef)(),W=Object(n.useRef)(),V=Object(n.useRef)(),X=Object(n.useRef)(),z=Object(n.useRef)(),A=Object(n.useRef)(),U=Object(n.useRef)(),Y=Object(n.useRef)(),q=Object(o.e)();let H=!1,J=0,Z=0,B=0,G=0,K=!1,Q=!1,ee=[],te=[],ae=null;Object(n.useEffect)(()=>{if($(window.location.href.split("?").length>1),window.location.href.split("?").length>1){$dispatch(Object(m.b)(q));const e={filePath:q.filePath||"",filenameOrigin:q.filenameOrigin,duration:q.duration,original:q.original,musicDataList:[],pageType:q.original,filename:q.filename,musicId:q.id,songOriginal:q.original,songInfo:q};Object(d.c)()||(e.checkLastMusicWhenLaunch=!0),Object(o.w)(V.current,["swipeLeft","swipeRight"],ne,j),Object(o.k)(e)}return document.addEventListener("deviceready",ie,!1),N||Object(o.w)(V.current,["swipeLeft","swipeRight"],ne,j),W.current.addEventListener("touchstart",se,!1),W.current.addEventListener("mousedown",se,!1),W.current.addEventListener("touchmove",ce,!1),W.current.addEventListener("mousemove",ce,!1),W.current.addEventListener("click",ce,!1),window.addEventListener("touchend",le),window.addEventListener("mouseup",le),re(h),()=>{document.removeEventListener("deviceready",ie,!1),document.removeEventListener("backbutton",ve,!1),W.current.removeEventListener("touchstart",se),W.current.removeEventListener("mousedown",se),W.current.removeEventListener("touchmove",ce),W.current.removeEventListener("mousemove",ce),W.current.removeEventListener("click",ce),window.removeEventListener("touchend",le),window.removeEventListener("mouseup",le),Object(o.q)(V.current)}},[]),Object(n.useEffect)(()=>{re(h)},[h]),Object(n.useEffect)(()=>{F(O?O.split(/\[.+\]/):["暂无歌词"])},[O]),Object(n.useEffect)(()=>(L?(X.current.style.left="0px",X.current.addEventListener("touchstart",oe,!1),X.current.addEventListener("touchmove",me,!1),X.current.addEventListener("touchend",de,!1)):(X.current.style.left="100vw",X.current.removeEventListener("touchstart",oe,!1),X.current.removeEventListener("touchmove",me,!1),X.current.removeEventListener("touchend",de,!1)),()=>{X.current.style.left="100vw",X.current.removeEventListener("touchstart",oe,!1),X.current.removeEventListener("touchmove",me,!1),X.current.removeEventListener("touchend",de,!1)}),[L]);const ne=e=>{logger.info("touchDirectionCallback direction, isHeadPhoneView",e,p),"left"===e?(logger.info("switch to head phone"),$dispatch(Object(m.n)(!0)),$dispatch(Object(m.o)(!1))):"right"===e?(logger.info("switch to amazing baby"),$dispatch(Object(m.n)(!1)),$dispatch(Object(m.o)(!1))):"lyric"===e&&(logger.info("switch to lyric"),$dispatch(Object(m.n)(!1)),$dispatch(Object(m.o)(!0)))},ie=()=>{document.addEventListener("backbutton",ve,!1)},re=e=>{const t=e/w.duration,a=window.innerWidth-124;z.current.style.width=a*t+"px",A.current.style.width=a*(1-t)+"px",A.current.style.left=a*t+14+"px",U.current.style.left=a*t+"px",Y.current.style.left=a*t+3+"px"},se=e=>{e.stopPropagation(),H=!0,logger.info("鼠标按下"),k(!0)},ce=e=>{e.stopPropagation();const t=w.duration||q.duration,{soundInstance:a,soundInstanceId:n}=$getState().fileServer;if(H){const i=W.current.offsetWidth-14,r=e.clientX||e.touches[0].pageX;let s=r-55>i?i:r-55;const c=((s=r-55<0?0:s)/i).toFixed(2),l=t*c;logger.info("move music progress move percent, seekTime",c,l),$dispatch(Object(m.h)(l)),a&&n&&a.seek(l,n)}else if(e.clientX&&!Object(d.a)()){const i=t*((e.clientX-55)/(W.current.offsetWidth-14)).toFixed(2);$dispatch(Object(m.h)(i)),a&&n&&a.seek(i,n)}},le=e=>{e.stopPropagation(),logger.info("鼠标弹起"),H=!1,k(!1)},oe=e=>{e.stopPropagation(),B=e.clientX||e.touches[0].pageX,G=e.clientY||e.touches[0].pageY,logger.info("startPage offsetFirstXValue",B,"offsetFirstYValue",G)},me=e=>{e.stopPropagation();const t=e.clientX||e.touches[0].pageX,a=e.clientY||e.touches[0].pageY;Z=a-G,(J=t-B)>0&&(Math.abs(Z)>5&&!0!==K?Q=!0:(J>=Math.abs(Z)&&!0!==Q||K)&&(K=!0,X.current.style.left=J+"px",X.current.style.transition="left 0s"))},de=e=>{e.stopPropagation(),logger.info("endPage offsetXValue",J,"offsetYValue",Z),J>0&&K?(K=!1,ue()):Q&&(Q=!1)},ue=()=>{J>0&&J<=I/2?J<25?(J=0,X.current.style.left=0,X.current.style.transition="left 0.2s"):(J-=25,X.current.style.left=J+"px",window.requestAnimationFrame(ue)):J>I/2&&J<I?(X.current.style.left=J+"px",J+=25,window.requestAnimationFrame(ue)):J>=I&&(J=0,$dispatch(Object(m.y)(!1)),X.current.style.transition="left 0.2s")},ve=()=>{Object(d.m)(),ge()},ge=()=>{M?alert("请手动关闭页面"):$getState().fileServer.showMusicPlayingFromMusicControl?J>=I?(J=0,$dispatch(Object(m.y)(!1)),X.current.style.transition="left 0.2s"):(J+=25,X.current.style.left=J+"px",X.current.style.transition="left 0s",window.requestAnimationFrame(ge)):window.cancelMenuFirst||_.push("/my_download_middle_page")},fe=()=>{M?Ee():L&&"/saved_songs"===window.getRoute()&&"savedSongs"==f?(X.current.style.top=Z+"px",(Z+=35)>=T?(X.current.style.top="0px",X.current.style.left="100vw",X.current.style.transition="left 0s",setTimeout(()=>{X.current.style.transition="left 0.2s",$dispatch(Object(m.y)(!1))},300)):window.requestAnimationFrame(fe)):($dispatch(Object(m.y)(!1)),he())},he=()=>{const e=window.getRoute();switch(Object(o.d)(),f){case v.a.musicOriginal.musicShare:"/main/music"!==e&&_.push("/main/music");break;case v.a.musicOriginal.savedSongs:"/saved_songs"!==e&&_.push("/saved_songs");break;case v.a.musicOriginal.musicFinished:"/my_finished_musics"!==e&&_.push("/my_finished_musics");break;case v.a.musicOriginal.musicRecent:"/recent_music_played"!==e&&_.push("/recent_music_played");break;case"onlySearchShareMusic":"/search_music"!==e&&_.push("/search_music");break;case"onlineMusic":"/search_online_music"!==e&&_.push("/search_online_music");break;case"onlineMusicSearchALl":"/onlineMusicSearchALl"!==e&&_.push("/search_all");break;default:alert("请选择一首歌播放")}},pe=e=>{if(w&&w.filePath){if(w.filePath.includes("cdvfile://localhost/sdcard/miXingFeng/music/"))return alertDialog("不能分享已下载的音乐，请上传后分享");{let t=Wechat.Scene.SESSION;"weChat"===e?t=Wechat.Scene.SESSION:"timeLine"===e&&(t=Wechat.Scene.TIMELINE);const a=JSON.parse(JSON.stringify(w));w.filePath.includes("api.zhoushoujian.com")||delete a.filePath,a.isFromThirdPart="weChat";let n=`${v.a.appStaticDirectory}#/music_playing`;const i=[];for(let e in a)i.push(`${e}=${a[e]}`);return n=`${n}?${i.join("&")}`,logger.info("webpageUrl: "+n),Object(d.k)({title:`音乐: ${a.filename} (${Object(o.v)(a.duration)})`,description:"觅星峰，每个人都能享受好音乐",thumb:`${v.a.appStaticDirectory}logo.png`,webpageUrl:n,scene:t})}}alert("请选择一首歌播放")},Ee=()=>{Object(d.c)()?C(!0):Object(d.j)({filenameOrigin:"shareMusicFromThirdPart",fileUrl:v.a.appDownloadUrl,folder:v.a.downloadAppFromPage})};e&&(ee=a.map(e=>Object(o.o)(e.filenameOrigin)),te=t.map(e=>e.filenameOrigin),ae=te.indexOf(e));const be=w.saved||"savedSongs"===r,ye=w.filename?Object(o.p)(Object(o.f)(w.filename)):"当前没有播放音乐";return i.a.createElement("div",{className:`music-playing-container\n\t\t\t\t${E?"lyric-view":""} ${p?"head-phone-view":"amazing-baby-view"}\n\t\t\t\t${N&&L?"from-music-control":"/music_playing"===getRoute()?"not-from-music-control":""}`,ref:X},i.a.createElement(c.a,{centerText:ye,backToPreviousPage:ge,rightText:"源页面",rightTextFunc:fe}),i.a.createElement("div",{className:"music-playing-content"},i.a.createElement("div",{className:"top",ref:V},i.a.createElement("div",{className:"music-singer"},w.uploadUsername),E?i.a.createElement("div",{className:`lyric-view-container ${1===x.length?"no-lyric":""}`},x.map((e,t)=>e&&e.trim()?i.a.createElement("div",{className:"lyric",key:t},e):null)):p?i.a.createElement("div",{className:"music"},i.a.createElement("span",{className:`line line1 ${g?"line-animation":"line-height"}`}),i.a.createElement("span",{className:`line line2 ${g?"line-animation":"line-height"}`}),i.a.createElement("span",{className:`line line3 ${g?"line-animation":"line-height"}`}),i.a.createElement("span",{className:`line line4 ${g?"line-animation":"line-height"}`}),i.a.createElement("span",{className:`line line5 ${g?"line-animation":"line-height"}`})):i.a.createElement(u,null),M?i.a.createElement("div",{className:"download-button",onClick:Ee},"下载"):null,!M&&window.isCordova?i.a.createElement("i",{className:"fa fa-share share","aria-hidden":"true",onClick:pe.bind(void 0,"weChat")}):null,i.a.createElement("div",{className:"circle"},i.a.createElement("div",{className:`dot ${E?"dot-fill":""}`,onClick:ne.bind(void 0,"lyric")}),i.a.createElement("div",{className:`dot ${E||p?"":"dot-fill"}`,onClick:ne.bind(void 0,"right")}),i.a.createElement("div",{className:`dot ${!E&&p?"dot-fill":""}`,onClick:ne.bind(void 0,"left")})),!M&&window.isCordova?i.a.createElement("i",{className:"fa fa-share-alt share","aria-hidden":"true",onClick:pe.bind(void 0,"timeLine")}):null),i.a.createElement("div",{className:"play-progress"},i.a.createElement("div",{className:"current-time"},Object(o.v)(h)),i.a.createElement("div",{className:"progress",ref:W},i.a.createElement("div",{className:"progress-played",ref:z}),i.a.createElement("div",{className:"progress-unplayed",ref:A}),i.a.createElement("div",{className:`progress-out-point ${S?"selected-animation":""}`,ref:U}),i.a.createElement("div",{className:"progress-inner-point",ref:Y})),i.a.createElement("div",{className:"duration-time"},Object(o.v)(w.duration||0))),i.a.createElement("div",{className:"bottom-controller"},i.a.createElement("div",{className:`save-svg ${be?"save-song-svg":""}`,onClick:n=>((e,t,a,n,i,r,s,c)=>{M?Ee():Object(o.u)({savedMusicFilenameOriginalArr:e,filenameOrigin:t,musicCollection:a,musicDataList:n,currentFileIndex:i,original:r,e:s,pageType:c})})(ee,e,a,t,ae,r,n,f)},i.a.createElement(l,null)),i.a.createElement("div",{className:"fa fa-step-backward play-previous",onClick:e=>((e,t,a,n,i)=>{M?Ee():Object(o.m)(e,t,a,n,i)})(ae,te,r,t,e)}),i.a.createElement("div",{className:"play-or-pause"},g?i.a.createElement("div",{className:"fa fa-pause",ref:D,onClick:t=>{t&&t.stopPropagation(),(b||y)&&(logger.info("MusicController pause currentPlayingSong",e),Object(o.j)(b,y,e))}}):i.a.createElement("div",{className:"fa fa-play",ref:R,onClick:t=>{if(logger.info("isFromThirdPart",M),t&&t.stopPropagation(),!b&&!y&&!e)return alert("请选择一首歌播放");logger.info("MusicController resume currentPlayingSong",e),Object(o.r)()}})),i.a.createElement("div",{className:"fa fa-step-forward play-next",onClick:e=>((e,t,a,n,i)=>{M?Ee():Object(o.l)(e,t,a,n,i)})(ae,te,r,t,e)}),i.a.createElement("i",{className:"fa fa-download download-song","aria-hidden":"true",onClick:()=>((e,t,a,n,i,r,s,c,l,m)=>{if(M)Ee();else{if(!t&&!r)return alert("请选择一首歌播放");Object(o.t)({musicDataList:e,filename:t,uploadUsername:a,fileSize:n,musicSrc:i,filenameOrigin:r,duration:s,songOriginal:c,musicId:l,payDownload:m})}})(t,w.filename,w.uploadUsername,w.fileSize,w.filePath,w.filenameOrigin,w.duration,w.original,w.id,Number(w.payDownload))})),P?i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"open-with-browser"},i.a.createElement("div",{className:"text1"},"链接打不开?"),i.a.createElement("div",{className:"text2"},"请点击右上角 ",i.a.createElement("strong",null,". . .")),i.a.createElement("div",{className:"text2"},'选择在"浏览器"打开')),i.a.createElement("div",{className:"overlay",onClick:()=>C(!1)})):null))})}}]);