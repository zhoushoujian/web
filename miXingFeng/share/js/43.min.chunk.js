(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{203:function(e,t,s){"use strict";var a=s(0),i=s.n(a);t.a=(()=>i.a.createElement("div",{className:"top-status-bar"}))},204:function(e,t,s){"use strict";var a=s(0),i=s.n(a),l=s(203);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:s="",rightTextFunc:n=(()=>{})})=>i.a.createElement(a.Fragment,null,i.a.createElement(l.a,null),i.a.createElement("div",{className:"navbar-container"},i.a.createElement("div",{className:"back-btn",onClick:t},i.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),i.a.createElement("div",{className:"center-text"},e),i.a.createElement("div",{className:"other-text",onClick:n},s))))},260:function(e,t,s){"use strict";var a=s(0),i=s.n(a),l=s(71),n=s(204),o=s(8),u=s(4),r=s(10),c=s(7),m=s(11);const p=[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105,229];t.a=Object(l.connect)(e=>({setTempEmail:e.myInfo.setTempEmail,username:e.login.username,hasForgetPassword:e.login.hasForgetPassword,setTempMobile:e.myInfo.setTempMobile,forgetPasswordToken:e.login.forgetPasswordToken,token:e.login.token,setMobile:e.myInfo.setMobile,userId:e.login.userId}),()=>({}))(class extends i.a.Component{constructor(e){super(e),this.backToMainPage=(()=>{const{forgetPasswordToken:e,self:t,token:s}=this.props;this.isEmail?e&&!s?($dispatch(Object(m.b)("")),$dispatch(Object(m.c)("")),goRoute(t,"/forget_password")):goRoute(t,"/set_email"):this.isMobile&&(e&&!s?($dispatch(Object(m.b)("")),$dispatch(Object(m.c)("")),goRoute(t,"/forget_password")):goRoute(t,"/set_mobile"))}),this.switchNextInput=((e,t)=>{if(8===e.keyCode){if(!this[`inputValueRef${t}`].value&&1!==t){const e=--t;this[`inputValueRef${e}`].value="",this[`inputValueRef${e}`].focus(),this.clearInputColor(),this[`inputValueRef${e}`].style.borderBottom="1px solid red"}return}const s=this.inputValueRef1.value,a=this.inputValueRef2.value,i=this.inputValueRef3.value,l=this.inputValueRef4.value;s&&a&&i&&l?this.submit():4!==t&&p.includes(e.keyCode)?setTimeout(()=>{const e=this.inputValueRef1.value,s=this.inputValueRef2.value,a=this.inputValueRef3.value,i=this.inputValueRef4.value;e&&s&&a&&i?this.submit():(this[`inputValueRef${++t}`].focus(),this.clearInputColor(),this[`inputValueRef${t}`].style.borderBottom="1px solid red")},10):setTimeout(()=>{const e=this.inputValueRef1.value,t=this.inputValueRef2.value,s=this.inputValueRef3.value,a=this.inputValueRef4.value;e&&t&&s&&a&&this.submit()},10)}),this.clearInputColor=(()=>{this.inputValueRef1.style.borderBottom="1px solid #000",this.inputValueRef2.style.borderBottom="1px solid #000",this.inputValueRef3.style.borderBottom="1px solid #000",this.inputValueRef4.style.borderBottom="1px solid #000"}),this.submit=(()=>{const e=this.inputValueRef1.value+this.inputValueRef2.value+this.inputValueRef3.value+this.inputValueRef4.value,{username:t,setTempEmail:s,setTempMobile:a,hasForgetPassword:i,self:l,forgetPasswordToken:n,setMobile:p,userId:h}=this.props;logger.info("checkEmail submit value",e);const d=this.isEmail?r.a.checkEmailValid.format({value:e,username:t||p,email:s,mobile:p}):this.isMobile?r.a.checkMobileValid.format({value:e,username:t,mobile:a||p}):null;if(d)return Object(u.A)(),axios.get(d).then(e=>{if(window.toast.hide(),window.cancelAxiosRequest)return;const t=e.data.result;if("modify_success"===t.response){if(this.isEmail)$dispatch(Object(c.g)(s)),$dispatch(Object(c.p)("")),i?($dispatch(Object(m.d)(!1)),goRoute(l,"/reset_password_sys")):(t.token&&$dispatch(Object(m.j)(t.token)),alert("设置成功"),goRoute(l,"/user_profile"));else if(this.isMobile){const{username:e}=this.props;e||(localStorage.setItem("oldUserId",h||""),$dispatch(Object(m.k)(a))),$dispatch(Object(c.j)(a)),$dispatch(Object(c.q)("")),$dispatch(Object(m.j)(t.token)),n?(Object(o.a)(t.token,!0),goRoute(l,"/reset_password_sys")):(alert("设置成功"),goRoute(l,"/user_profile"))}}else{if("no_username_or_value"===t.response)return alert("没有用户名或验证码或邮箱");if("code_wrong"===t.response)return alert("验证码错误");if("check_mobile_success"!==t.response)return"illegal_mobile"===t.response?alert("手机号错误"):"no_username_or_value_or_mobile"===t.response?alert("没有用户名或验证码或手机号"):alert("设置失败");$dispatch(Object(m.j)(t.token)),$dispatch(Object(c.j)(a)),$dispatch(Object(c.q)("")),localStorage.setItem("oldUserId",h||""),$dispatch(Object(m.k)(a)),goRoute(l,"/register")}}).catch(e=>(window.toast.hide(),Object(u.q)(e,this.isEmail?"checkEmailValid":"checkMobileValid"))).finally(()=>{window.cancelAxiosRequest=!1})}),this.isEmail="email"===e.type,this.isMobile="mobile"===e.type,this.state={leftTime:60}}componentDidMount(){const e=setInterval(()=>{let{leftTime:t}=this.state;if(t<=0)return clearInterval(e);this.setState({leftTime:--t})},1e3);this.inputValueRef1.style.borderBottom="1px solid red",this.inputValueRef1.focus()}render(){const{leftTime:e}=this.state,{setTempEmail:t,setTempMobile:s}=this.props;return i.a.createElement("div",{className:"check-email-input-container"},i.a.createElement(n.a,{centerText:"填写验证码",backToPreviousPage:this.backToMainPage,rightText:e||""}),i.a.createElement("div",{className:"check-email-input-content"},i.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef1=e,onKeyDown:e=>this.switchNextInput(e,1)}),i.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef2=e,onKeyDown:e=>this.switchNextInput(e,2)}),i.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef3=e,onKeyDown:e=>this.switchNextInput(e,3)}),i.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef4=e,onKeyDown:e=>this.switchNextInput(e,4)})),this.isEmail?i.a.createElement(a.Fragment,null,i.a.createElement("div",{className:"tips"},"提示：设置邮箱可用于找回密码, 验证码10分钟有效;",i.a.createElement("br",null),"您刚输入的邮箱：",i.a.createElement("strong",null,t),i.a.createElement("br",null),"如果收件箱找不到邮件，请检查邮件是否被邮箱拦截。 ")):i.a.createElement("div",{className:"tips"},"提示：手机号: ",i.a.createElement("strong",null,s),", 验证码10分钟有效;"))}})},503:function(e,t,s){"use strict";s.r(t);var a=s(0),i=s.n(a),l=s(260);t.default=(()=>i.a.createElement(l.a,{type:"email",self:void 0}))}}]);