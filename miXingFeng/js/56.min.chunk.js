(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{334:function(e,t,s){"use strict";var i=s(0),a=s.n(i),l=s(335);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:s="",rightTextFunc:o=(()=>{})})=>a.a.createElement(i.Fragment,null,a.a.createElement(l.a,null),a.a.createElement("div",{className:"navbar-container"},a.a.createElement("div",{className:"back-btn",onClick:t},a.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),a.a.createElement("div",{className:"center-text"},e),a.a.createElement("div",{className:"other-text",onClick:o},s))))},335:function(e,t,s){"use strict";var i=s(0),a=s.n(i);t.a=(()=>a.a.createElement("div",{className:"top-status-bar"}))},392:function(e,t,s){"use strict";var i=s(0),a=s.n(i),l=s(95),o=s(334),n=s(70),r=s(3),u=s(8),c=s(7),m=s(10),h=s(9);const p=[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105,229];t.a=Object(l.connect)(e=>({setTempEmail:e.myInfo.setTempEmail,username:e.login.username,hasForgetPassword:e.login.hasForgetPassword,setTempMobile:e.myInfo.setTempMobile,forgetPasswordToken:e.login.forgetPasswordToken,token:e.login.token,setMobile:e.myInfo.setMobile,userId:e.login.userId,phoneOrEmailToResend:e.myInfo.phoneOrEmailToResend,tryMobileOrEmailTimes:e.common.tryMobileOrEmailTimes}),()=>({}))(class extends a.a.Component{constructor(e){super(e),this.countLeftTime=(()=>{const e=setInterval(()=>{let{leftTime:t}=this.state;if(t<=1)return this.setState({leftTime:"重新发送"}),clearInterval(e);this.setState({leftTime:--t})},1e3)}),this.backToMainPage=(()=>{const{forgetPasswordToken:e,self:t,token:s}=this.props;this.isEmail?e&&!s?($dispatch(Object(m.b)("")),$dispatch(Object(m.c)("")),goRoute(t,"/forget_password")):goRoute(t,"/set_email"):this.isMobile&&(e&&!s?($dispatch(Object(m.b)("")),$dispatch(Object(m.c)("")),goRoute(t,"/forget_password")):goRoute(t,"/set_mobile"))}),this.switchNextInput=((e,t)=>{if(8===e.keyCode){if(!this[`inputValueRef${t}`].value&&1!==t){const e=--t;this[`inputValueRef${e}`].value="",this[`inputValueRef${e}`].focus(),this.clearInputColor(),this[`inputValueRef${e}`].style.borderBottom="1px solid red"}return}const s=this.inputValueRef1.value,i=this.inputValueRef2.value,a=this.inputValueRef3.value,l=this.inputValueRef4.value;s&&i&&a&&l?this.submit():4!==t&&p.includes(e.keyCode)?setTimeout(()=>{const e=this.inputValueRef1.value,s=this.inputValueRef2.value,i=this.inputValueRef3.value,a=this.inputValueRef4.value;e&&s&&i&&a?this.submit():(this[`inputValueRef${++t}`].focus(),this.clearInputColor(),this[`inputValueRef${t}`].style.borderBottom="1px solid red")},10):setTimeout(()=>{const e=this.inputValueRef1.value,t=this.inputValueRef2.value,s=this.inputValueRef3.value,i=this.inputValueRef4.value;e&&t&&s&&i&&this.submit()},10)}),this.clearInputColor=(()=>{this.inputValueRef1.style.borderBottom="1px solid #000",this.inputValueRef2.style.borderBottom="1px solid #000",this.inputValueRef3.style.borderBottom="1px solid #000",this.inputValueRef4.style.borderBottom="1px solid #000"}),this.submit=(()=>{const e=this.inputValueRef1.value+this.inputValueRef2.value+this.inputValueRef3.value+this.inputValueRef4.value,{username:t,setTempEmail:s,setTempMobile:i,hasForgetPassword:a,self:l,forgetPasswordToken:o,setMobile:h,userId:p}=this.props;logger.info("checkEmail submit value",e);const d=this.isEmail?u.a.checkEmailValid.format({value:e,username:t||h,email:s,mobile:h}):this.isMobile?u.a.checkMobileValid.format({value:e,username:t,mobile:i||h}):null;if(d)return Object(r.B)(),axios.get(d).then(e=>{if(window.toast.hide(),!window.cancelAxiosRequest)if("modify_success"===e.response){if($dispatch(Object(c.f)(null)),this.isEmail)$dispatch(Object(c.k)(s)),$dispatch(Object(c.t)("")),a?($dispatch(Object(m.d)(!1)),goRoute(l,"/reset_password_sys")):(e.token&&$dispatch(Object(m.j)(e.token)),alert("设置成功"),goRoute(l,"/user_profile"));else if(this.isMobile){const{username:t}=this.props;t||(localStorage.setItem("oldUserId",p||""),$dispatch(Object(m.k)(i))),$dispatch(Object(c.n)(i)),$dispatch(Object(c.u)("")),$dispatch(Object(m.j)(e.token)),o?(Object(n.a)(e.token),goRoute(l,"/reset_password_sys")):(alert("设置成功"),goRoute(l,"/user_profile"))}}else{if("no_username_or_value"===e.response)return alert("没有用户名或验证码或邮箱");if("code_wrong"===e.response)return alert("验证码错误");if("check_mobile_success"!==e.response)return"illegal_mobile"===e.response?alert("手机号错误"):"no_username_or_value_or_mobile"===e.response?alert("没有用户名或验证码或手机号"):alert("设置失败");$dispatch(Object(m.j)(e.token)),$dispatch(Object(c.n)(i)),$dispatch(Object(c.u)("")),localStorage.setItem("oldUserId",p||""),$dispatch(Object(m.k)(i)),goRoute(l,"/register"),$dispatch(Object(c.f)(null))}}).catch(e=>(window.toast.hide(),Object(r.q)(e,this.isEmail?"checkEmailValid":"checkMobileValid"))).finally(()=>{window.cancelAxiosRequest=!1})}),this.rightTextFunc=(()=>{const{leftTime:e}=this.state,{phoneOrEmailToResend:t,tryMobileOrEmailTimes:s}=this.props;if("重新发送"===e)if(t){if(s>=3)return alertDialog("您的操作太频繁，请稍后重试");this.setState({leftTime:60}),this.countLeftTime(),Object(r.B)(),axios.post(t.url,t).then(e=>{window.toast.hide(),Object(h.S)(s),"send_email_success"===e.response?alert("验证码已发送邮箱，请注意查收"):"send_mobile_success"===e.response&&alert("手机验证码已发送，请注意查收")}).catch(e=>(window.toast.hide(),Object(r.q)(e,`updateUserInfo data: ${t}`))).finally(()=>{window.cancelAxiosRequest=!1})}else this.backToMainPage()}),this.isEmail="email"===e.type,this.isMobile="mobile"===e.type,this.state={leftTime:60}}componentDidMount(){this.countLeftTime(),this.inputValueRef1.style.borderBottom="1px solid red",this.inputValueRef1.focus()}render(){const{leftTime:e}=this.state,{setTempEmail:t,setTempMobile:s}=this.props;return a.a.createElement("div",{className:"check-email-input-container"},a.a.createElement(o.a,{centerText:"填写验证码",backToPreviousPage:this.backToMainPage,rightText:e||"",rightTextFunc:this.rightTextFunc}),a.a.createElement("div",{className:"check-email-input-content"},a.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef1=e,onKeyDown:e=>this.switchNextInput(e,1)}),a.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef2=e,onKeyDown:e=>this.switchNextInput(e,2)}),a.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef3=e,onKeyDown:e=>this.switchNextInput(e,3)}),a.a.createElement("input",{className:"check-email-input",maxLength:1,ref:e=>this.inputValueRef4=e,onKeyDown:e=>this.switchNextInput(e,4)})),this.isEmail?a.a.createElement(i.Fragment,null,a.a.createElement("div",{className:"tips"},"提示：设置邮箱可用于找回密码, 验证码10分钟有效;",a.a.createElement("br",null),"您刚输入的邮箱：",a.a.createElement("strong",null,t),a.a.createElement("br",null),"如果收件箱找不到邮件，请检查邮件是否被邮箱拦截。 ")):a.a.createElement("div",{className:"tips"},"提示：手机号: ",a.a.createElement("strong",null,s),", 验证码10分钟有效;"))}})},595:function(e,t,s){"use strict";s.r(t);var i=s(0),a=s.n(i),l=s(392);t.default=(()=>a.a.createElement(l.a,{type:"mobile",self:void 0}))}}]);