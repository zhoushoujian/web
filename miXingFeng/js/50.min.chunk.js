(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{210:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(211);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:c=(()=>{})})=>r.a.createElement(n.Fragment,null,r.a.createElement(s.a,null),r.a.createElement("div",{className:"navbar-container"},r.a.createElement("div",{className:"back-btn",onClick:t},r.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),r.a.createElement("div",{className:"center-text"},e),r.a.createElement("div",{className:"other-text",onClick:c},a))))},211:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=(()=>r.a.createElement("div",{className:"top-status-bar"}))},219:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const c=Object(n.forwardRef)((e,t)=>{const{type:a="text",placeholder:n="",value:c="",handleKeyDown:o=(()=>{}),handleChange:i=(()=>{}),maxLength:l=26,style:h={},handleClick:u=(()=>{}),handleBlur:d=(()=>{}),className:m,disabled:p=!1}=e;return r.a.createElement("input",s({},e,{className:`input-component ${m}`,type:a,placeholder:n,value:c,onKeyDown:o,onChange:i,maxLength:l,autoComplete:"off",style:h,onClick:u,onBlur:d,ref:t,disabled:p}))});t.a=c},545:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(75),c=a(210),o=a(219),i=a(6),l=a(8),h=a(3);t.default=Object(s.connect)(e=>({poetryKeyword:e.common.poetryKeyword,poetryList:e.common.poetryList,token:e.login.token}),()=>({}))(class extends r.a.Component{constructor(...e){var t;return t=super(...e),this.search=!1,this.listenBackButton=(()=>{document.addEventListener("backbutton",this.backKeyDownToPrevious,!1)}),this.backKeyDownToPrevious=(()=>{Object(h.z)(),this.backToMainPage()}),this.backToMainPage=(()=>{Object(h.b)("/search_column",!1)}),this.updateValue=(e=>{e?($dispatch(Object(i.A)(e.target.value)),clearTimeout(this.searchPoetry),this.searchPoetry=setTimeout(()=>{this.pressEnter({keyCode:13,autoSearch:!0})},800)):$dispatch(Object(i.A)(""))}),this.pressEnter=(e=>{if(13===e.keyCode){const{token:t,poetryKeyword:a}=this.props;if(!t)return void goRoute(this,"/login");if(!a)return alert("请输入关键词");if(!/^[\u4e00-\u9fa5]+$/g.test(a))return alert("标题或内容必须都是中文");if(this.search)return;return this.search=!0,e.autoSearch||(this.inputRef.blur(),Object(h.B)()),axios.get(l.a.searchForPoetry.format({keyword:a})).then(e=>{window.toast.hide();const t=e.response;if(!t.length)return $dispatch(Object(i.B)([])),alert("没查找任何记录");t.forEach(e=>{e.titleString=e.title.split(a).join(`<span class="hight-light-keyword">${a}</span>`),e.paragraphsString=e.paragraphs.join(",").split(a).join(`<span class="hight-light-keyword">${a}</span>`)}),$dispatch(Object(i.B)(t))}).catch(e=>{window.toast.hide(),Object(h.q)(e,"SearchPoetry")}).finally(()=>{this.search=!1})}}),this.gotoDetail=(e=>{$dispatch(Object(i.z)(e)),goRoute(this,"/poetry_content")}),t}componentDidMount(){document.addEventListener("deviceready",this.listenBackButton,!1)}componentWillUnmount(){document.removeEventListener("deviceready",this.listenBackButton,!1),document.removeEventListener("backbutton",this.backKeyDownToPrevious,!1)}render(){const{poetryKeyword:e,poetryList:t}=this.props;return r.a.createElement("div",{className:"search-poetry-container"},r.a.createElement(c.a,{centerText:"搜索古典诗词",backToPreviousPage:this.backToMainPage}),r.a.createElement("div",{className:"search-poetry-content"},r.a.createElement("div",{className:"search-poetry-input"},r.a.createElement(o.a,{ref:e=>this.inputRef=e,autoFocus:!e,value:e,placeholder:"标题或内容",maxLength:64,handleChange:e=>this.updateValue(e),handleKeyDown:this.pressEnter,className:"search-input-content"}),r.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"}),e&&r.a.createElement("i",{className:"fa fa-times-circle-o","aria-hidden":"true",onClick:()=>this.updateValue()})),r.a.createElement("div",{className:"search-poetry-list-container"},t.length?t.map((e,t)=>r.a.createElement("div",{className:"search-poetry-list",key:t,onClick:()=>this.gotoDetail(e)},r.a.createElement("div",{className:`num ${Object(h.d)(t+1)}`},t+1),r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"title-author"},r.a.createElement("div",{className:"poetry-title",title:e.title,dangerouslySetInnerHTML:{__html:e.titleString}}),r.a.createElement("div",{className:"poetry-author"},e.author)),r.a.createElement("div",{className:"content",title:e.paragraphs.join(","),dangerouslySetInnerHTML:{__html:e.paragraphsString}})))):r.a.createElement("div",{className:"search-poetry-default-info"},"共收录24万余首古典诗词"))))}})}}]);