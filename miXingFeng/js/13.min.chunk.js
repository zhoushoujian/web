(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{336:function(e,t,a){"use strict";var n=a(0),r=a.n(n),l=a(337);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:i=(()=>{})})=>r.a.createElement(n.Fragment,null,r.a.createElement(l.a,null),r.a.createElement("div",{className:"navbar-container"},r.a.createElement("div",{className:"back-btn",onClick:t},r.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),r.a.createElement("div",{className:"center-text"},e),r.a.createElement("div",{className:"other-text",onClick:i},a))))},337:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=(()=>r.a.createElement("div",{className:"top-status-bar"}))},356:function(e,t,a){"use strict";a(96),a(148),a(319)},357:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(a(14)),r=p(a(25)),l=p(a(16)),i=p(a(17)),o=p(a(15)),s=p(a(18)),c=p(a(26)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),f=p(a(146)),d=p(a(149));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a},g=/^[\u4e00-\u9fa5]{2}$/,h=g.test.bind(g);function v(e){return"string"==typeof e}function b(e){return v(e.type)&&h(e.props.children)?u.cloneElement(e,{},e.props.children.split("").join(" ")):v(e)?(h(e)&&(e=e.split("").join(" ")),u.createElement("span",null,e)):e}var y=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e,t=this.props,a=t.children,l=t.className,i=t.prefixCls,o=t.type,s=t.size,p=t.inline,g=t.disabled,h=t.icon,v=t.loading,y=t.activeStyle,w=t.activeClassName,C=t.onClick,k=m(t,["children","className","prefixCls","type","size","inline","disabled","icon","loading","activeStyle","activeClassName","onClick"]),O=v?"loading":h,x=(0,c.default)(i,l,(e={},(0,r.default)(e,i+"-primary","primary"===o),(0,r.default)(e,i+"-ghost","ghost"===o),(0,r.default)(e,i+"-warning","warning"===o),(0,r.default)(e,i+"-small","small"===s),(0,r.default)(e,i+"-inline",p),(0,r.default)(e,i+"-disabled",g),(0,r.default)(e,i+"-loading",v),(0,r.default)(e,i+"-icon",!!O),e)),_=u.Children.map(a,b),E=void 0;if("string"==typeof O)E=u.createElement(d.default,{"aria-hidden":"true",type:O,size:"small"===s?"xxs":"md",className:i+"-icon"});else if(O){var P=O.props&&O.props.className,j=(0,c.default)("am-icon",i+"-icon","small"===s?"am-icon-xxs":"am-icon-md");E=u.cloneElement(O,{className:P?P+" "+j:j})}return u.createElement(f.default,{activeClassName:w||(y?i+"-active":void 0),disabled:g,activeStyle:y},u.createElement("a",(0,n.default)({role:"button",className:x},k,{onClick:g?void 0:C,"aria-disabled":g}),E,_))}}]),t}(u.Component);y.defaultProps={prefixCls:"am-button",size:"large",inline:!1,disabled:!1,loading:!1,activeStyle:{}},t.default=y,e.exports=t.default},405:function(e,t,a){e.exports=a(29)(29)},409:function(e,t,a){e.exports=a(29)(13)},443:function(e,t,a){"use strict";a(96),a(444),a(325)},444:function(e,t,a){"use strict";a(96),a(324)},445:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(16)),r=f(a(17)),l=f(a(15)),i=f(a(18)),o=f(a(26)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),c=f(a(146)),u=f(a(446));function f(e){return e&&e.__esModule?e:{default:e}}function d(){}var p=function(e){function t(){(0,n.default)(this,t);var e=(0,l.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getOrientation=function(e,t){var a=new FileReader;a.onload=function(e){var a=new DataView(e.target.result);if(65496!==a.getUint16(0,!1))return t(-2);for(var n=a.byteLength,r=2;r<n;){var l=a.getUint16(r,!1);if(r+=2,65505===l){if(1165519206!==a.getUint32(r+=2,!1))return t(-1);var i=18761===a.getUint16(r+=6,!1);r+=a.getUint32(r+4,i);var o=a.getUint16(r,i);r+=2;for(var s=0;s<o;s++)if(274===a.getUint16(r+12*s,i))return t(a.getUint16(r+12*s+8,i))}else{if(65280!=(65280&l))break;r+=a.getUint16(r,!1)}}return t(-1)},a.readAsArrayBuffer(e.slice(0,65536))},e.getRotation=function(){var e=0;switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 3:e=180;break;case 6:e=90;break;case 8:e=270}return e},e.removeImage=function(t){var a=[],n=e.props.files;(void 0===n?[]:n).forEach(function(e,n){t!==n&&a.push(e)}),e.props.onChange&&e.props.onChange(a,"remove",t)},e.addImage=function(t){var a=e.props.files,n=(void 0===a?[]:a).concat(t);e.props.onChange&&e.props.onChange(n,"add")},e.onImageClick=function(t){e.props.onImageClick&&e.props.onImageClick(t,e.props.files)},e.onFileChange=function(){var t=e.fileSelectorInput;if(t&&t.files&&t.files.length){for(var a=t.files,n=[],r=0;r<a.length;r++)n.push(e.parseFile(a[r],r));Promise.all(n).then(function(t){return e.addImage(t)}).catch(function(t){e.props.onFail&&e.props.onFail(t)})}t&&(t.value="")},e.parseFile=function(t,a){return new Promise(function(n,r){var l=new FileReader;l.onload=function(l){var i=l.target.result;if(i){var o=1;e.getOrientation(t,function(e){e>0&&(o=e),n({url:i,orientation:o,file:t})})}else r("Fail to get the "+a+" image")},l.readAsDataURL(t)})},e}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.prefixCls,n=t.style,r=t.className,l=t.files,i=void 0===l?[]:l,f=t.selectable,d=t.onAddImageClick,p=t.multiple,m=t.accept,g=t.capture,h=t.disableDelete,v=[],b=parseInt(""+this.props.length,10);b<=0&&(b=4);var y=(0,o.default)(""+a,r);i.forEach(function(t,n){var r={backgroundImage:'url("'+t.url+'")',transform:"rotate("+e.getRotation(t.orientation)+"deg)"};v.push(s.createElement(u.default.Item,{key:"item-"+n,style:{}},s.createElement("div",{key:n,className:a+"-item"},!h&&s.createElement("div",{className:a+"-item-remove",role:"button","aria-label":"Click and Remove this image",onClick:function(){e.removeImage(n)}}),s.createElement("div",{className:a+"-item-content",role:"button","aria-label":"Image can be clicked",onClick:function(){e.onImageClick(n)},style:r}))))});var w=s.createElement(u.default.Item,{key:"select"},s.createElement(c.default,{activeClassName:a+"-upload-btn-active"},s.createElement("div",{className:a+"-item "+a+"-upload-btn",onClick:d,role:"button","aria-label":"Choose and add image"},s.createElement("input",{ref:function(t){t&&(e.fileSelectorInput=t)},type:"file",accept:m,onChange:function(){e.onFileChange()},multiple:p,capture:g})))),C=f?v.concat([w]):v,k=C.length;if(0!==k&&k%b!=0){for(var O=b-k%b,x=[],_=0;_<O;_++)x.push(s.createElement(u.default.Item,{key:"blank-"+_}));C=C.concat(x)}for(var E=[],P=0;P<C.length/b;P++){var j=C.slice(P*b,P*b+b);E.push(j)}var N=E.map(function(e,t){return s.createElement(u.default,{key:"flex-"+t},e)});return s.createElement("div",{className:y,style:n},s.createElement("div",{className:a+"-list",role:"group"},N))}}]),t}(s.Component);t.default=p,p.defaultProps={prefixCls:"am-image-picker",files:[],onChange:d,onImageClick:d,onAddImageClick:d,onFail:d,selectable:!0,multiple:!1,accept:"image/*",length:4,disableDelete:!1},e.exports=t.default},446:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(447)),r=l(a(448));function l(e){return e&&e.__esModule?e:{default:e}}n.default.Item=r.default,t.default=n.default,e.exports=t.default},447:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(14)),r=f(a(25)),l=f(a(16)),i=f(a(17)),o=f(a(15)),s=f(a(18)),c=f(a(26)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a},p=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e,t=this.props,a=t.direction,l=t.wrap,i=t.justify,o=t.align,s=t.alignContent,f=t.className,p=t.children,m=t.prefixCls,g=t.style,h=d(t,["direction","wrap","justify","align","alignContent","className","children","prefixCls","style"]),v=(0,c.default)(m,f,(e={},(0,r.default)(e,m+"-dir-row","row"===a),(0,r.default)(e,m+"-dir-row-reverse","row-reverse"===a),(0,r.default)(e,m+"-dir-column","column"===a),(0,r.default)(e,m+"-dir-column-reverse","column-reverse"===a),(0,r.default)(e,m+"-nowrap","nowrap"===l),(0,r.default)(e,m+"-wrap","wrap"===l),(0,r.default)(e,m+"-wrap-reverse","wrap-reverse"===l),(0,r.default)(e,m+"-justify-start","start"===i),(0,r.default)(e,m+"-justify-end","end"===i),(0,r.default)(e,m+"-justify-center","center"===i),(0,r.default)(e,m+"-justify-between","between"===i),(0,r.default)(e,m+"-justify-around","around"===i),(0,r.default)(e,m+"-align-start","start"===o),(0,r.default)(e,m+"-align-center","center"===o),(0,r.default)(e,m+"-align-end","end"===o),(0,r.default)(e,m+"-align-baseline","baseline"===o),(0,r.default)(e,m+"-align-stretch","stretch"===o),(0,r.default)(e,m+"-align-content-start","start"===s),(0,r.default)(e,m+"-align-content-end","end"===s),(0,r.default)(e,m+"-align-content-center","center"===s),(0,r.default)(e,m+"-align-content-between","between"===s),(0,r.default)(e,m+"-align-content-around","around"===s),(0,r.default)(e,m+"-align-content-stretch","stretch"===s),e));return u.createElement("div",(0,n.default)({className:v,style:g},h),p)}}]),t}(u.Component);t.default=p,p.defaultProps={prefixCls:"am-flexbox",align:"center"},e.exports=t.default},448:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(14)),r=u(a(16)),l=u(a(17)),i=u(a(15)),o=u(a(18)),s=u(a(26)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0));function u(e){return e&&e.__esModule?e:{default:e}}var f=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a},d=function(e){function t(){return(0,r.default)(this,t),(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.className,r=e.prefixCls,l=e.style,i=f(e,["children","className","prefixCls","style"]),o=(0,s.default)(r+"-item",a);return c.createElement("div",(0,n.default)({className:o,style:l},i),t)}}]),t}(c.Component);t.default=d,d.defaultProps={prefixCls:"am-flexbox"},e.exports=t.default},568:function(e,t,a){"use strict";a.r(t);a(356);var n=a(357),r=a.n(n),l=(a(403),a(404)),i=a.n(l),o=(a(359),a(362)),s=a.n(o),c=(a(443),a(445)),u=a.n(c),f=(a(99),a(21)),d=a.n(f),p=a(0),m=a.n(p),g=a(441),h=a(336),v=a(8),b=a(3),y=a(2),w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const C=Object(g.a)()(class extends m.a.Component{constructor(...e){var t;return t=super(...e),this.state={files:[],uploadLog:!0},this.onChange=((e,t,a)=>{this.setState({files:e})}),this.backToMainPage=(()=>{goRoute(this,"/system_setup")}),this.submitFeedback=(()=>{const{files:e,uploadLog:t}=this.state,a=e.length,n=[],r=this.feedbackTextareaRef.value;if(r.length>1e3)return alert("不允许超过1000个字");if(!r)return alert("请描述您遇到的问题或建议");n.push((new Date).format("yyyy-MM-dd hh:mm:ss")),n.push(r);let l="";a&&(l=e[0].file.name.split(".").pop());const i=$getState().login.username||$getState().myInfo.setMobile||$getState().login.userId,o=t&&isCordova,s=Object.assign({},{username:i},{feedbackContent:n},{extname:l,needUploadLog:o});this.startToSubmit||(this.startToSubmit=!0,axios.post(v.a.feedback,s).then(e=>(this.startToSubmit=!1,d.a.success("提交成功, 非常感谢您的反馈",y.a.toastTime),e.filename)).then(t=>{if(t){if(a){const a=new FormData,n={headers:{"Content-Type":"multipart/form-data"}};a.append("files",e[0].file),a.append("type","feedbackImage"),a.append("filename",`${t}.${l}`),axios.post(v.a.uploadFile,a,n).then(e=>{logger.info("upload feedback pic result",e)}).catch(e=>Promise.reject(e))}o&&new Promise(e=>{if(!window.LocalFileSystem)return e();window.requestFileSystem(window.LocalFileSystem.PERSISTENT,0,function(a){a.root.getDirectory("miXingFeng",{create:!0},function(a){a.getDirectory("log",{create:!0},function(a){a.getFile("miXingFeng.txt",{create:!0,exclusive:!1},function(a){const n=a.toURL();logger.info("upload log filename",t);const r=new window.FileUploadOptions;r.fileKey="file",r.fileName=t,r.mimeType="text/plain";const l={value1:"put your params here"};r.params=l,(new window.FileTransfer).upload(n,encodeURI(v.a.uploadPic),function(t){logger.info("upload log success",t),e()},function(t){alertDebug("An error has occurred: Code = "+t.code),logger.error("upload error source "+t.source),logger.error("upload error target "+t.target),e()},r)})})})})})}}).catch(e=>(this.startToSubmit=!1,Object(b.q)(e,`submitFeedback feedback data ${JSON.stringify(s)}`))).finally(()=>{}))}),this.onChangeUploadLog=(e=>{const{form:t}=this.props;t.setFieldsValue({Switch1:e}),this.setState({uploadLog:e})}),t}render(){const{files:e,uploadLog:t}=this.state,{form:a}=this.props,{getFieldProps:n}=a;return m.a.createElement("div",{className:"feedback-container"},m.a.createElement(h.a,{centerText:"反馈",backToPreviousPage:this.backToMainPage}),m.a.createElement("div",{className:"feedback-content"},m.a.createElement("textarea",{className:"feedback-textarea",placeholder:"请详细描述你遇到的问题或建议",ref:e=>this.feedbackTextareaRef=e}),m.a.createElement(u.a,{files:e,onChange:this.onChange,selectable:e.length<1,accept:"image/jpeg,image/jpg,image/png"}),m.a.createElement("div",{className:"upload-log"},m.a.createElement(s.a.Item,{extra:m.a.createElement(i.a,w({},n("Switch1",{initialValue:t,valuePropName:"checked"}),{platform:"ios",onClick:this.onChangeUploadLog}))},"上传日志")),m.a.createElement("div",{className:"submit-feedback"},m.a.createElement(r.a,{type:"primary",className:"button",value:"提交",onClick:this.submitFeedback},"提交"))))}});t.default=C}}]);