(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{210:function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(211);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:c=(()=>{})})=>s.a.createElement(n.Fragment,null,s.a.createElement(i.a,null),s.a.createElement("div",{className:"navbar-container"},s.a.createElement("div",{className:"back-btn",onClick:t},s.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),s.a.createElement("div",{className:"center-text"},e),s.a.createElement("div",{className:"other-text",onClick:c},a))))},211:function(e,t,a){"use strict";var n=a(0),s=a.n(n);t.a=(()=>s.a.createElement("div",{className:"top-status-bar"}))},480:function(e,t,a){e.exports=a(27)(5)},481:function(e,t,a){e.exports=a(27)(1)},482:function(e,t,a){e.exports=a(27)(6)},548:function(e,t,a){"use strict";a.r(t);a(222);var n=a(223),s=a.n(n),i=a(0),c=a.n(i),o=a(75),r=a(329),l=a(210),d=a(36),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};var u=({onDragEnd:e,droppableId:t="droppable",children:a})=>c.a.createElement(r.a,{onDragEnd:e},c.a.createElement(r.c,{droppableId:t},(e,t)=>c.a.createElement("div",m({},e.droppableProps,{ref:e.innerRef}),a,e.placeholder))),h=a(3),g=a(1),p=a(8),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};let b;new RegExp("\\biPhone\\b|\\biPod\\b","i").test(navigator.userAgent)&&(b={onTouchStart:e=>e.preventDefault()});t.default=Object(o.connect)(e=>({mySongList:e.fileServer.mySongList,mySongListDetail:e.fileServer.mySongListDetail}),()=>({}))(class extends c.a.Component{constructor(e){super(e),this.listenBackButton=(()=>{document.addEventListener("backbutton",this.handleMusicBackEventFunc,!1)}),this.handleMusicBackEventFunc=(()=>{Object(h.z)(),this.backToMainPage()}),this.backToMainPage=(()=>{Object(h.b)("/my_download_middle_page",!1)}),this.listenBackFunc=(()=>{window.cancelMenuFirst=!0,document.addEventListener("backbutton",this.closeShowMenu,!1)}),this.removeListenBackFunc=(()=>{window.cancelMenuFirst=!1,document.removeEventListener("backbutton",this.closeShowMenu),document.removeEventListener("deviceready",this.listenBackFunc),document.addEventListener("backbutton",h.r,!1),document.addEventListener("backbutton",this.handleMusicBackEventFunc,!1)}),this.closeShowMenu=(()=>{window.cancelMenuFirst=!1;const e=document.querySelector(".am-action-sheet-button-list div:nth-last-child(1)");e&&e.click(),e&&e.click(),this.removeListenBackFunc()}),this.gotoListDetail=(e=>{$dispatch(Object(g.U)(e)),goRoute(this,"/my_song_lists_detail")}),this.changeList=(()=>{const{currentListId:e}=this.state,{mySongList:t}=this.props;if(!this.listNameRef.value)return alert("必须输入歌单名称");const a=e||Date.now().toString(36),n=JSON.parse(JSON.stringify(t));return n[a]={id:a,name:this.listNameRef.value,desc:this.listDescRef.value},axios.post(p.a.mySongList,{mySongList:n}).then(()=>{$dispatch(Object(g.W)(n)),this.setState({currentListId:null}),e?alert("编辑成功"):alert("新建成功")}).catch(e=>{Object(h.q)(e,"MySongListsPage changeList fail")})}),this.showMenu=((e,t,a,n)=>{try{e.stopPropagation(),document.removeEventListener("backbutton",h.r,!1),document.removeEventListener("backbutton",this.handleMusicBackEventFunc,!1),document.addEventListener("deviceready",this.listenBackFunc);const i=["编辑","删除","取消"],o={options:i,cancelButtonIndex:i.length-1,destructiveButtonIndex:i.length-2,message:"",title:"菜单",maskClosable:!0,"data-seed":"logId",wrapProps:b};s.a.showActionSheetWithOptions(o,e=>{const{mySongList:s}=this.props;switch(logger.info("MySongListsPage showMenu buttonIndex",e),e){case 0:this.setState({currentListId:t}),Object(h.j)("编辑歌单",this.modalElement(),"确定",this.changeList),setTimeout(()=>{this.listNameRef.value=a,this.listDescRef.value=n});break;case 1:Object(h.j)("提示",c.a.createElement(d.a,{textFragment:`确定删除歌单 <span class="delete-alert">${a}</span> 吗`}),"确定",function(){const e=JSON.parse(JSON.stringify(s));delete e[t],axios.post(p.a.mySongList,{mySongList:e}).then(()=>{$dispatch(Object(g.W)(e)),alert("删除成功")}).catch(e=>{Object(h.q)(e,"MySongListsPage remove list fail")})});break;default:logger.warn("MySongListsPage buttonIndex default")}this.removeListenBackFunc()})}catch(e){logger.error("fileManage showMenu err",e)}}),this.rightTextFunc=(()=>{isElectron?alertDialog("只有移动端才可以创建歌单"):(this.setState({currentListId:null}),Object(h.j)("新建歌单",this.modalElement(),"确定",this.changeList))}),this.modalElement=(()=>c.a.createElement("div",null,c.a.createElement("div",{className:"modal-my-song-list-content"},c.a.createElement("div",{className:"content"},c.a.createElement("input",{ref:e=>this.listNameRef=e,size:"26",placeholder:"请输入名称(必填)",className:"input-component",autoFocus:!0}),c.a.createElement("div",{className:"my-song-list-name"},"歌单名称"))),c.a.createElement("div",{className:"modal-my-song-list-content"},c.a.createElement("div",{className:"content"},c.a.createElement("input",{ref:e=>this.listDescRef=e,size:"64",placeholder:"请输入描述(选填)",className:"input-component"}),c.a.createElement("div",{className:"my-song-list-name"},"歌单描述"))))),this.dragEnd=(e=>{if(!e.destination)return;const{mySongList:t}=this.props,a=JSON.parse(JSON.stringify(t)),n=Object.values(a),[s]=n.splice(e.source.index,1);n.splice(e.destination.index,0,s);const i={};return n.forEach(e=>i[e.id]=e),$dispatch(Object(g.W)(i)),axios.post(p.a.mySongList,{mySongList:i}).catch(e=>{$dispatch(Object(g.W)(a)),Object(h.q)(e,"MySongListsPage dragEnd fail")})}),this.state={currentListId:null}}componentDidMount(){document.addEventListener("deviceready",this.listenBackButton,!1)}componentWillUnmount(){document.removeEventListener("deviceready",this.listenBackButton),document.removeEventListener("backbutton",this.handleMusicBackEventFunc)}render(){const{mySongList:e,mySongListDetail:t}=this.props,a=JSON.parse(JSON.stringify(e)),n=Object.values(a).map(e=>(e.number=t[e.id]?t[e.id].length:0,e))||[];return c.a.createElement("div",{className:"my-song-list-page-container"},c.a.createElement(l.a,{centerText:"我的歌单",backToPreviousPage:this.backToMainPage,rightText:c.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true",style:{cursor:"pointer"}}),rightTextFunc:this.rightTextFunc}),c.a.createElement("div",{className:"my-song-list-page-content"},c.a.createElement(u,{onDragEnd:this.dragEnd,droppableId:"droppable"},n.map((e,t)=>c.a.createElement(r.b,{key:e.id,index:t,draggableId:e.id},(a,n)=>c.a.createElement("div",v({ref:a.innerRef},a.draggableProps,a.dragHandleProps),c.a.createElement("div",{className:"my-song-list-page-item",onClick:()=>this.gotoListDetail(e)},c.a.createElement("div",{className:"my-song-list-page-info"},c.a.createElement("i",{className:`fa fa-gg-circle ${Object(h.d)(t+1)}-song-list`,"aria-hidden":"true"}),c.a.createElement("div",{className:"info"},c.a.createElement("div",{className:"filename"},e.name,"(",e.number,")"),c.a.createElement("div",{className:"description"},e.desc))),c.a.createElement("div",{className:"menu",onClick:t=>this.showMenu(t,e.id,e.name,e.desc)},c.a.createElement("div",{className:"dot"}),c.a.createElement("div",{className:"dot"}),c.a.createElement("div",{className:"dot"})),c.a.createElement("svg",{t:"1603353495359",className:"sort",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4323",width:"16",height:"16",onClick:t=>this.showMenu(t,e.id,e.name,e.desc)},c.a.createElement("path",{d:"M288 192a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0 277.312a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0 277.376a96 96 0 1 1 0-192 96 96 0 0 1 0 192zM288 1024a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m448-832a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0 277.312a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0 277.376a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0 277.312a96 96 0 1 1 0-192 96 96 0 0 1 0 192z",fill:"#8a8a8a","p-id":"4324"})))))))))}})}}]);