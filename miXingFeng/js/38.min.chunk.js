(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{334:function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(335);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:o=(()=>{})})=>s.a.createElement(n.Fragment,null,s.a.createElement(i.a,null),s.a.createElement("div",{className:"navbar-container"},s.a.createElement("div",{className:"back-btn",onClick:t},s.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),s.a.createElement("div",{className:"center-text"},e),s.a.createElement("div",{className:"other-text",onClick:o},a))))},335:function(e,t,a){"use strict";var n=a(0),s=a.n(n);t.a=(()=>s.a.createElement("div",{className:"top-status-bar"}))},343:function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const o=Object(n.forwardRef)((e,t)=>{const{type:a="text",placeholder:n="",value:o="",handleKeyDown:r=(()=>{}),handleChange:c=(()=>{}),maxLength:l=26,style:u={},handleClick:h=(()=>{}),handleBlur:d=(()=>{}),className:m,disabled:p=!1}=e;return s.a.createElement("input",i({},e,{className:`input-component ${m}`,type:a,placeholder:n,value:o,onKeyDown:r,onChange:c,maxLength:l,autoComplete:"off",style:u,onClick:h,onBlur:d,ref:t,disabled:p}))});t.a=o},382:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(0),s=a.n(n);class i extends n.Component{render(){const{item:e,query:t,select:a}=this.props,n=e.toLowerCase().indexOf(t.toLowerCase()),i=t.length,o=e.slice(0,n)+"<b>"+e.slice(n,n+i)+"</b>"+e.slice(n+i);return s.a.createElement("div",{className:"auto-suggest-name",onClick:()=>a(e),dangerouslySetInnerHTML:{__html:o}})}}},581:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(95),o=a(9),r=a(334),c=a(382),l=a(343),u=a(3);t.default=Object(i.connect)(e=>({username:e.login.username,token:e.login.token,currentLocation:e.common.currentLocation,currentXYPosition:e.common.currentXYPosition,currentProvince:e.common.currentProvince,setMobile:e.myInfo.setMobile}),()=>({}))(class extends n.Component{constructor(e){super(e),this.searchPosition=(()=>{const{token:e,username:t,setMobile:a}=this.props;if(!e)return goRoute(this,"/login");const{searchString:n}=this.state;return this.setState({isSearching:!0}),Object(o.P)(n).then(e=>{this.setState({positionText:e.positionText||"位置不可用",oppositeXYPosition:e.currentXYPosition||[0,0],isSearching:!1,status:e.status||"离线",typedUsername:n},()=>{t===n||a===n?this.updateBaiduMap():e.positionText&&"位置不可用"!==e.positionText&&e.currentXYPosition&&0!==e.currentXYPosition[0]&&this.updateBaiduMap()})}).catch(e=>{Object(u.q)(e,`searchPosition searchString:${n}`)})}),this.keyDownEvent=(e=>{const t=e,{token:a}=this.props;if(13===t.keyCode)return a?(this.blur(),this.searchPosition()):goRoute(this,"/login")}),this.backToMainPage=(()=>{goRoute(this,"/search_column")}),this.blur=(()=>{setTimeout(()=>{this.setState({ulPadding:"0",ulDisplay:"none"})},300)}),this.select=(e=>{this.setState({searchString:e,ulPadding:"0",ulDisplay:"none"},this.searchPosition)}),this.updateBaiduMap=(()=>{let{positionText:e,positionXY:t,searchString:a,oppositeXYPosition:n}=this.state,{username:s,currentProvince:i,setMobile:o}=this.props;if(0===t[0]&&0===t[1]){if(0===n[0]||0===n[1])return;s=a,t=n}0!==t[0]&&0!==t[1]&&0!==n[0]&&0!==n[1]&&(Math.abs(t[0]-n[0])<1e-4||Math.abs(t[1]-n[1])<5e-5)&&(s=a,t=n);const r=new window.BMap.Map("map_canvas");if(r.enableScrollWheelZoom(),a===s||a===o){const a=new window.BMap.Point(t[0],t[1]);r.centerAndZoom(a,12),(new window.BMap.Geocoder).getPoint(e,function(e){e?(r.centerAndZoom(e,16),r.addOverlay(new window.BMap.Marker(e))):alert("您选择地址没有解析到结果!")},i)}else{const e=new window.BMap.DrivingRoute(i,{onSearchComplete:function(t){if(e.getStatus()===window.BMAP_STATUS_SUCCESS){const e=t.getPlan(0);let a=[];for(let t=0;t<e.getNumRoutes();t++){const n=e.getRoute(t);a=a.concat(n.getPath())}r.addOverlay(new window.BMap.Polyline(a,{strokeColor:"#111"})),r.setViewport(a)}}}),a=new window.BMap.Point(t[0],t[1]),s=new window.BMap.Point(n[0],n[1]);e.search(a,s)}}),this.state={positionText:e.currentLocation||"位置不可用",positionXY:e.currentXYPosition||[0,0],oppositeXYPosition:[0,0],searchString:e.token?e.username||e.setMobile:"",autoSuggestList:[],isSearching:!1,status:"在线",typedUsername:"",ulPadding:"0",ulDisplay:"block"}}componentDidMount(){const{token:e}=this.props;e&&this.searchPosition()}render(){const{positionText:e,isSearching:t,searchString:a,autoSuggestList:i,status:u,typedUsername:h,ulPadding:d,ulDisplay:m}=this.state,{token:p}=this.props;return s.a.createElement("div",{className:"search-history-container"},s.a.createElement(r.a,{centerText:"搜索地理位置",backToPreviousPage:this.backToMainPage}),s.a.createElement("div",{className:"search-header"},s.a.createElement("div",{className:"search-input"},s.a.createElement(l.a,{value:a,placeholder:p?a:"请输入您要搜索的用户名",handleChange:e=>Object(o.U)(e.target.value,this),handleKeyDown:this.keyDownEvent,handleBlur:this.blur,className:"search-input-content"}),s.a.createElement("div",{className:"ul",style:{padding:d,display:m}},i.length?i.map((e,t)=>s.a.createElement(c.a,{key:t,item:e,query:a,select:this.select})):null),s.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"}))),s.a.createElement("div",{className:"search-position-container"},t?a&&s.a.createElement("div",{className:"searching"},"正在查询..."):s.a.createElement("div",{className:"search-position-content"},s.a.createElement("div",{className:"search-string"},"用户名：",h),s.a.createElement("div",{className:"user-status"},"状态：",u),s.a.createElement("div",{className:"position-text"},"位置：",e))),!t&&s.a.createElement(n.Fragment,null,s.a.createElement("div",{id:"map_canvas"}),s.a.createElement("div",{id:"result"})))}})}}]);