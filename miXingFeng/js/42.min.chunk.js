(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{334:function(e,t,a){"use strict";var n=a(0),s=a.n(n),o=a(335);t.a=(({centerText:e="",backToPreviousPage:t=(()=>{}),rightText:a="",rightTextFunc:r=(()=>{})})=>s.a.createElement(n.Fragment,null,s.a.createElement(o.a,null),s.a.createElement("div",{className:"navbar-container"},s.a.createElement("div",{className:"back-btn",onClick:t},s.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),s.a.createElement("div",{className:"center-text"},e),s.a.createElement("div",{className:"other-text",onClick:r},a))))},335:function(e,t,a){"use strict";var n=a(0),s=a.n(n);t.a=(()=>s.a.createElement("div",{className:"top-status-bar"}))},343:function(e,t,a){"use strict";var n=a(0),s=a.n(n),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const r=Object(n.forwardRef)((e,t)=>{const{type:a="text",placeholder:n="",value:r="",handleKeyDown:i=(()=>{}),handleChange:l=(()=>{}),maxLength:c=26,style:u={},handleClick:f=(()=>{}),handleBlur:p=(()=>{}),className:m,disabled:d=!1}=e;return s.a.createElement("input",o({},e,{className:`input-component ${m}`,type:a,placeholder:n,value:r,onKeyDown:i,onChange:l,maxLength:c,autoComplete:"off",style:u,onClick:f,onBlur:p,ref:t,disabled:d}))});t.a=r},365:function(e,t,a){"use strict";a(354);var n=a(355),s=a.n(n),o=(a(374),a(375)),r=a.n(o),i=a(0),l=a.n(i),c=a(343),u=a(8),f=a(3),p=a(10),m=a(2),d=a(9),h=a(7);var g=function(){this.saveUserInfo=(()=>{const{infoLength:e,infoErrorTip:t,updateUserInfoDispatch:a,pageTitle:n,name:s,backToMainPage:o,self:r}=this.props;let i=this.state.inputValue;const{tryMobileOrEmailTimes:l=0}=$getState().common;if(i.length>e)return alert(t);if(!i)return;if("填写手机号"===n){if(!1===Object(d.j)(i))return alert(t);if(i===$getState().myInfo.setMobile)return;if(l>=3)return alertDialog("您的操作太频繁，请稍后重试")}else if("填写邮箱"===n){if(!1===Object(d.e)(i))return alert("邮箱格式不正确");if(i===$getState().myInfo.setEmail)return;if(l>=3)return alertDialog("您的操作太频繁，请稍后重试")}else if("设置用户名"===n){if(!/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/.test(i))return logger.info("saveUserInfo 用户名只能由字母,数字或中文组成",i),alertDialog("用户名只能由字母，数字或中文组成");if(/^[0-9]/i.test(i))return logger.info("saveUserInfo 用户名首字母不能是数字",i),alertDialog("用户名首字母不能是数字")}i=i.replace(/\s/g,"");const{username:c,token:g}=$getState().login,{setMobile:b}=$getState().myInfo;if(!g)return alertDialog("没有token");const v=Object.assign({},{username:c||b,token:g,userInfo:{[s]:i}});"填写邮箱"!==n&&"填写手机号"!==n||(v.url=u.a.updateUserInfo,$dispatch(Object(h.f)(v)),Object(f.B)()),logger.info("UpdateUserInfoComponent saveUserInfo data",v),axios.post(u.a.updateUserInfo,v).then(e=>{window.toast.hide(),window.cancelAxiosRequest||("modify_success"===e.response?(Toast.success("保存成功",m.a.toastTime),$dispatch(Object(p.j)(e.token)),$dispatch(a(i)),o()):"lack_fields"===e.response?Toast.fail("缺少必要的字段",m.a.toastTime):"more_string_length"===e.response?Toast.fail("字数超过长度限制",m.a.toastTime):"wrong_email_format"===e.response?Toast.fail("错误的邮箱格式",m.a.toastTime):"email_existed"===e.response?alertDialog("此邮箱已绑定到其他账号，请更换邮箱后重试"):"username_existed"===e.response?alertDialog("此用户名已被注册，请更换后重试"):"send_email_success"===e.response?(Object(d.S)(l),alert("验证码已发送邮箱，请注意查收"),$dispatch(Object(p.j)(e.token)),$dispatch(a(i)),goRoute(r,"/check_email")):"wrong_mobile_format"===e.response?Toast.fail("错误的手机号格式",m.a.toastTime):"mobile_existed"===e.response?alertDialog("此手机号已绑定到其他账号，请更换手机号重试"):"mobile_existed_from_register"===e.response?Object(f.j)("此手机号已被注册","","去登录",()=>{goRoute(r,"/login")}):"send_mobile_success"===e.response?(Object(d.S)(l),alert("手机验证码已发送，请注意查收"),$dispatch(a(i)),goRoute(r,"/check_mobile")):(logger.error("saveUserInfo updateUserInfo 设置失败 result",e),Toast.fail("设置失败",m.a.toastTime)))}).catch(e=>(window.toast.hide(),e&&e.result&&e.result.errText&&e.result.errText.includes("Mailbox not found or access denied")?alertDialog("未找到该邮箱地址,请检查邮箱"):Object(f.q)(e,`updateUserInfo data: ${v}`))).finally(()=>{window.cancelAxiosRequest=!1})}),this.keyDownEvent=(e=>{if(13===e.keyCode)return this.saveUserInfo()}),this.updateValue=(e=>{let t=e;e.target&&(t=e.target.value),this.setState({inputValue:t})})};t.a=class extends l.a.Component{constructor(e){super(e),g.call(this);const{placeholder:t}=this.props;let a=t;"请输入昵称,最多10个字"!==t&&"请输入手机号"!==t&&"请输入签名"!==t&&"请输入邮箱"!==t&&"用户名可用于登录，全网唯一，设置后不可修改"!==t||(a=""),this.state={inputValue:a},this.userInfoInputRef=Object(i.createRef)()}componentDidMount(){setTimeout(()=>{this.userInfoInputRef&&this.userInfoInputRef.current&&this.userInfoInputRef.current.focus()})}render(){const{pageTitle:e,placeholder:t}=this.props,{inputValue:a}=this.state;return l.a.createElement("div",{className:"set-user-info-component-container"},l.a.createElement("div",{className:"set-user-info-component-content"},"填写手机号"===e?l.a.createElement(r.a,{type:"phone",placeholder:t,onChange:this.updateValue,onKeyDown:this.keyDownEvent}):l.a.createElement(c.a,{value:a,placeholder:t,handleChange:this.updateValue,handleKeyDown:this.keyDownEvent,ref:this.userInfoInputRef}),l.a.createElement("div",{className:"save-user-info"},l.a.createElement(s.a,{type:"primary",className:"button",value:"保存",onClick:this.saveUserInfo},"保存"))))}}},567:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(95),r=a(365),i=a(7),l=a(334);t.default=Object(o.connect)(e=>({setNickname:e.myInfo.setNickname,token:e.login.token}),()=>({}))(class extends s.a.Component{constructor(...e){var t;return t=super(...e),this.backToMainPage=(()=>{const{token:e}=this.props;e?goRoute(this,"/user_profile"):goRoute(this,"/main/myInfo")}),t}render(){let{setNickname:e}=this.props;return e=e||"请输入昵称,最多10个字",s.a.createElement("div",null,s.a.createElement(l.a,{centerText:"设置昵称",backToPreviousPage:this.backToMainPage}),s.a.createElement(r.a,{pageTitle:"设置昵称",placeholder:e,infoLength:10,infoErrorTip:"昵称不允许超过10个字",updateUserInfoDispatch:i.p,name:"nickname",backToMainPage:this.backToMainPage}))}})}}]);