(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{215:function(e,a,t){"use strict";var n=t(0),r=t.n(n);var i=()=>r.a.createElement("div",{className:"top-status-bar"});a.a=(({centerText:e="",backToPreviousPage:a=(()=>{}),rightText:t="",rightTextFunc:l=(()=>{})})=>r.a.createElement(n.Fragment,null,r.a.createElement(i,null),r.a.createElement("div",{className:"navbar-container"},r.a.createElement("div",{className:"back-btn",onClick:a},r.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),r.a.createElement("div",{className:"center-text"},e),r.a.createElement("div",{className:"other-text",onClick:l},t))))},264:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),i=t(52),l=t(11),o=t(244),c=(t(194),t(83)),s=t(215),u=t(2),d=t(8),m=t(25),v=t(4),g=t(1);t(193);let b="MV",p=!1,w="",f="";a.default=Object(i.b)(e=>({userId:e.login.userId}),()=>({}))(({location:e,userId:a})=>{const[t,i]=Object(n.useState)(!1),[E,y]=Object(n.useState)(null),h=Object(n.useRef)(),k=Object(l.f)();e&&e.query&&e.query&&(b=e.query.filename,w=e.query.mvId,f=e.query.original),Object(n.useEffect)(()=>{if(p=!!e.search){const e=Object(m.e)();if(!e.mvId)return alertDialog("视频播放失败, 请稍候再试");w=e.mvId,b=e.filename,f=e.original,a="weChatUser"+Math.random().toString(36).slice(-5)}else e&&e.query||(alertDebug("no location.query"),k.push("/main/myInfo")),document.addEventListener("deviceready",O,!1),Object(m.g)(),document.querySelector(".window-music-controller").style.display="none",Object(m.j)();let t=d.a.getQQMvLink;return f===u.a.musicOriginal.netEaseCloud?t=d.a.getNetEaseCloudMvLink:f===u.a.musicOriginal.qqMusic&&(t=d.a.getQQMvLink),axios.get(t.format({id:w,userId:a})).then(e=>{const a=e.data.result;a.response?(i(!0),y(a.response),h.current&&h.current.subscribeToStateChange(q)):(alertDialog("没有视频链接"),p||C("nav"))}).catch(e=>{Object(v.h)(e,"MusicMvPlayer")}),()=>{document.querySelector(".window-music-controller").style.display="flex",j(),document.removeEventListener("deviceready",O),document.removeEventListener("backbutton",C)}},[]);const O=()=>{window.plugins.insomnia.keepAwake(),document.addEventListener("backbutton",C,!1)},C=e=>{p?alert("请手动关闭页面"):("nav"===e&&window.history.back(),setTimeout(()=>{$dispatch(Object(g.x)(!0))},100))},j=()=>{window.isCordova&&(StatusBar.overlaysWebView(!1),StatusBar.backgroundColorByHexString(u.a.statusBarColor),screen.orientation.lock("portrait"),window.plugins.insomnia.allowSleepAgain())},q=(e,a)=>{e.isFullscreen!==a.isFullscreen&&(logger.info("listenVideoState state.isFullscreen, filename",e.isFullscreen,b),logger.info("listenVideoState prevState.isFullscreen, filename",a.isFullscreen,b),e.isFullscreen?window.isCordova&&(StatusBar.overlaysWebView(!0),screen.orientation.lock("landscape")):j())},S=()=>{Object(v.d)()?window.alertOld("链接打不开?请点击右上角...,选择在浏览器打开"):Object(v.k)({filenameOrigin:"shareMVFromThirdPart",fileUrl:u.a.appDownloadUrl,folder:u.a.downloadAppFromPage})};return r.a.createElement("div",{className:"music-mv-player-container"},r.a.createElement(s.a,{centerText:b,backToPreviousPage:C.bind(void 0,"nav")}),r.a.createElement("div",{className:"music-mv-player-content"},t?r.a.createElement(n.Fragment,null,r.a.createElement(o.Player,{ref:h,autoPlay:!0},r.a.createElement(o.ControlBar,{autoHide:!0}),r.a.createElement("source",{src:E}),r.a.createElement(o.BigPlayButton,{position:"center"})),p?r.a.createElement("div",{className:"weChat-tips"},r.a.createElement("div",{className:"open",onClick:S},"打开"),r.a.createElement("div",{className:"download",onClick:S},"下载")):r.a.createElement("div",{className:"mv-menu"},window.isCordova?r.a.createElement("i",{className:"fa fa-share share","aria-hidden":"true",onClick:()=>{const e={filename:b,mvId:w,original:f,isFromThirdPart:"weChat"};let a=`${u.a.appStaticDirectory}#/music_mv_Player`;const t=[];for(let a in e)t.push(`${a}=${e[a]}`);return a=`${a}?${t.join("&")}`,Object(v.m)({title:"MV: "+b,description:"我分享了一个MV,快来看看吧",thumb:`${u.a.appStaticDirectory}logo.png`,videoUrl:a})}}):null,r.a.createElement("i",{className:"fa fa-download download-song","aria-hidden":"true",onClick:()=>{if(p)S();else{const{original:a,filename:t}=e.query,n=a===u.a.musicOriginal.netEaseCloud?"网易云":a===u.a.musicOriginal.qqMusic?"qq音乐":"未知",r=t+".mp4";Object(m.s)(r,n,"未知",E,!1,r,k,null)}}}))):r.a.createElement(c.a,null)))})}}]);