(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{345:function(e,t,i){"use strict";var n=i(0),a=i.n(n),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};const r=Object(n.forwardRef)((e,t)=>{const{type:i="text",placeholder:n="",value:r="",handleKeyDown:o=(()=>{}),handleChange:l=(()=>{}),maxLength:c=26,style:g={},handleClick:h=(()=>{}),handleBlur:d=(()=>{}),className:u,disabled:m=!1}=e;return a.a.createElement("input",s({},e,{className:`input-component ${u}`,type:i,placeholder:n,value:r,onKeyDown:o,onChange:l,maxLength:c,autoComplete:"off",style:g,onClick:h,onBlur:d,ref:t,disabled:m}))});t.a=r},565:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),s=i(4),r=i(95),o=i(345),l=i(70),c=i(8),g=i(11),h=i(3),d=i(7);var u=function(){this.listenBackButton=(()=>{isCordova&&(window.JGJVerificationPlugin.setDebugMode(!0),window.JGJVerificationPlugin.init()),document.addEventListener("backbutton",this.backKeyDownToPrevious,!1)}),this.keepInputFocusWhenClickEye=(e=>{"fa fa-eye"===e.target.className&&e.preventDefault()}),this.keyDownEvent=(e=>{13===e.keyCode&&(this.loginUsernameRef.current.blur(),this.loginPasswordRef.current.blur(),this.login())}),this.login=(()=>{Object(l.b)(this.state.username,this.props.password,this)}),this.fingerprintLogin=(()=>{const{username:e}=this.state;if(localStorage.getItem("fingerprintAuthUsername")!==e)return alert("此账号没有可用的指纹识别信息");const t={clientId:"miXingFeng",username:e,token:localStorage.getItem("fingerprintAuthToken"),disableBackup:!0,maxAttempts:5,locale:"zh_CN"};window.FingerprintAuth.isAvailable(i=>{i.isAvailable?window.FingerprintAuth.decrypt(t,t=>{logger.info("fingerprintLogin successCallback(): "+JSON.stringify(t)),t.withFingerprint&&(logger.info("fingerprintLogin Successful biometric authentication."),t.password?(logger.info("Successfully decrypted credential token."),logger.info("password: "+t.password),Object(l.b)(e,t.password,this),localStorage.removeItem("fingerprintAuthPassword")):(logger.error("fingerprintLogin FingerprintAuth Error: 指纹识别失败,请稍候重试"),alert("指纹识别失败,请稍候重试")))},e=>{e===window.FingerprintAuth.ERRORS.FINGERPRINT_CANCELLED?logger.warn("fingerprintLogin FingerprintAuth Dialog Cancelled!"):(logger.error("fingerprintLogin FingerprintAuth Error: ",e),Object(h.a)("指纹识别失败: "+e))}):(logger.error("fingerprintLogin FingerprintAuth Error: 指纹识别不可用"),alert("指纹识别不可用"))})}),this.backKeyDownToPrevious=(()=>{window.toastLoading||Object(h.c)(this,"/main/home",{specialBack:!0})}),this.setUsername=(e=>{const t=e?e.target.value:"";this.setState({username:t})}),this.setPassword=(e=>{$dispatch(Object(g.h)(e.target.value||""))}),this.showOrHidePassword=(()=>{const{showAsPassword:e}=this.state;"password"===e?this.setState({showAsPassword:"text"},()=>{this.faEyeRef.style.color="#fff"}):this.setState({showAsPassword:"password"},()=>{this.faEyeRef.style.color="#000"})}),this.register=(()=>{if(isCordova){Object(h.B)();let e={setPrivacyState:!0,setPrivacyTextSize:12,setPrivacyCheckboxSize:14,setLogBtnText:"本机号码一键登录"};e=JSON.stringify(e),window.JGJVerificationPlugin.setCustomUIWithConfig(e),window.JGJVerificationPlugin.loginAuth(!0,function(e){if(window.toast.hide(),!window.cancelAxiosRequest)if(e=JSON.parse(e),logger.info("loginAuth response",e),6e3!==e.code&&6002!==e.code)logger.warn("一键登录失败 response",e),logger.warn("一键登录失败 response.code",e.code),goRoute(this,"/register");else if(6e3===e.code){let t="";"CM"===e.operator?t="中国移动":"CU"===e.operator?t="中国联通":"CT"===e.operator&&(t="中国电信"),$dispatch(Object(d.b)(t));const{userId:i}=$getState().login,n={JVerifyToken:e.content,userId:i,mobileCarrierOperator:t};return logger.info("register jiGuangVerify data",n),axios.post(c.a.jiGuangVerify,n).then(e=>{logger.info("login register jiGuangVerify result",e);const{mobile:t}=e;if($dispatch(Object(g.i)(e.token)),$dispatch(Object(d.n)(t)),"register_success"!==e.response)return"existed"===e.response?($dispatch(Object(g.e)(!0)),goRoute(this,"/main/home"),Object(l.a)(e.token)):(logger.error("login register jiGuangVerify  not success result",e),Object(h.a)("登录超时，请稍后重试"));$dispatch(Object(g.e)(!0)),goRoute(this,"/register")}).catch(e=>(logger.error("login register jiGuangVerify  catch error",e),Object(h.a)("登录超时，请稍后重试")))}},e=>{logger.info("loginAuth result",e)})}else goRoute(this,"/register")}),this.backToMainPage=(()=>{goRoute(this,"/main/home")}),this.handleClick=(()=>{isCordova&&(this.userClickInput=!0,setTimeout(()=>{this.userClickInput=!1},110),this.setState({showFingerprint:!1}))}),this.handleBlur=(()=>{isCordova&&setTimeout(()=>{this.userClickInput||this.setState({showFingerprint:!0})},100)})};t.default=Object(r.connect)(e=>({password:e.login.password,token:e.login.token,logOutFlag:e.login.logOutFlag,userId:e.login.userId,loginStatus:e.login.loginStatus}),()=>({}))(class extends n.Component{constructor(e){super(e),u.call(this);const t=localStorage.getItem("username"),i=localStorage.getItem("mobile"),a=localStorage.getItem("email");this.loginUsernameRef=Object(n.createRef)(),this.loginPasswordRef=Object(n.createRef)(),this.isExistFingerprintAuth="yes"===localStorage.getItem("fingerprintAuth"),this.userClickInput=!1,this.state={username:t||i||a||"",showAsPassword:"password",showFingerprint:!0}}componentDidMount(){const{logOutFlag:e,userId:t}=this.props;if(document.addEventListener("deviceready",this.listenBackButton,!1),document.addEventListener("mousedown",this.keepInputFocusWhenClickEye,!1),document.addEventListener("touchstart",this.keepInputFocusWhenClickEye,!1),e){const e=t||"",i=Object(h.n)();$dispatch(Object(g.j)(i)),localStorage.setItem("oldUserId",i),logger.info("Login replace userId original, newOne",e,i);const n={original:e,newOne:i};Object(h.t)(n,"logout case"),$dispatch(Object(g.f)(!1))}}componentWillUnmount(){document.removeEventListener("deviceready",this.listenBackButton),document.removeEventListener("backbutton",this.backKeyDownToPrevious),document.removeEventListener("mousedown",this.keepInputFocusWhenClickEye,!1),document.removeEventListener("touchstart",this.keepInputFocusWhenClickEye,!1)}render(){const{username:e,showAsPassword:t,showFingerprint:i}=this.state,{password:n,loginStatus:r}=this.props,l=localStorage.getItem("fingerprintAuthUsername")!==e;return a.a.createElement("div",{className:"first-page"},a.a.createElement("div",{className:"pic-blur"}),a.a.createElement("div",{className:"back-btn",onClick:this.backToMainPage},a.a.createElement("i",{className:"fa fa-angle-left","aria-hidden":"true"})),a.a.createElement("div",{className:"index"},a.a.createElement("div",{className:"head"},"欢迎登录觅星峰"),a.a.createElement("div",{className:"main"},a.a.createElement("div",{className:"input-content"},a.a.createElement("div",{className:"content"},a.a.createElement(o.a,{value:e,size:"26",placeholder:"用户名/手机号/邮箱",handleChange:this.setUsername,handleKeyDown:this.keyDownEvent,ref:this.loginUsernameRef,className:"login-page",handleClick:this.handleClick,handleBlur:this.handleBlur}),a.a.createElement("i",{className:"fa fa-user fa-inverse","aria-hidden":"true"}),a.a.createElement("div",{className:"login-center-input-text"},"账号"),a.a.createElement("i",{className:"fa fa-times-circle-o","aria-hidden":"true",onClick:()=>this.setUsername()}))),a.a.createElement("div",{className:"input-content"},a.a.createElement("div",{className:"content"},a.a.createElement(o.a,{type:t,value:n,size:"26",placeholder:"请输入登录密码",handleChange:this.setPassword,handleKeyDown:this.keyDownEvent,ref:this.loginPasswordRef,className:"login-page",handleClick:this.handleClick,handleBlur:this.handleBlur}),a.a.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"20px",height:"20px",viewBox:"0 0 20 20",enableBackground:"new 0 0 20 20",className:"fa fa-spoon",style:{left:"5px"}},a.a.createElement("path",{fill:"#fff",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M18.3,1.7h-2.8L8.8,8.4C8.3,8.1,7.6,8,7,8c-2.8,0-5,2.2-5,5s2.2,5,5,5s5-2.2,5-5c0-0.6-0.1-1.3-0.4-1.8l6.7-6.7V1.7z"}),a.a.createElement("circle",{fill:"#fff",stroke:"#D2D8D8",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",cx:"7",cy:"13",r:"1"})),a.a.createElement("div",{className:"login-center-input-text"},"密码"),a.a.createElement("i",{className:"fa fa-eye",ref:e=>this.faEyeRef=e,"aria-hidden":"true",onClick:this.showOrHidePassword}))),a.a.createElement("div",{className:"login-btn"},a.a.createElement("div",{className:"button",onClick:this.login},r))),a.a.createElement("div",{className:"foot"},a.a.createElement("span",{onClick:this.register},isCordova?"一键登录":"注册"),a.a.createElement(s.Link,{to:"/forget_password"},"忘记密码"))),this.isExistFingerprintAuth?a.a.createElement("div",{className:`fingerprint-svg ${l||!i?"disabled":""}`,ref:e=>this.fingerPrintSvgRef=e,onClick:this.fingerprintLogin},a.a.createElement("svg",{t:"1595574460941",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",pId:"1245",width:"48",height:"48"},a.a.createElement("defs",null,a.a.createElement("style",{type:"text/css"})),a.a.createElement("path",{d:"M113.431273 286.184727a23.272727 23.272727 0 0 1 40.494545 22.970182C114.362182 378.88 93.090909 458.984727 93.090909 542.487273a488.727273 488.727273 0 0 0 1.349818 36.235636 23.272727 23.272727 0 0 1-46.429091 3.444364A535.272727 535.272727 0 0 1 46.545455 542.487273c0-91.578182 23.342545-179.595636 66.885818-256.302546zM959.069091 681.029818a23.272727 23.272727 0 0 1-44.916364-12.241454c11.101091-40.657455 16.779636-83.083636 16.779637-126.301091 0-91.066182-25.274182-178.013091-71.842909-251.741091a23.272727 23.272727 0 0 1 39.330909-24.855273C949.690182 347.042909 977.454545 442.600727 977.454545 542.487273c0 47.383273-6.237091 93.882182-18.385454 138.542545zM829.696 180.014545a23.272727 23.272727 0 1 1-32.837818 32.977455C719.825455 136.378182 619.054545 93.090909 512 93.090909c-114.711273 0-222.068364 49.687273-300.520727 136.331636a23.272727 23.272727 0 0 1-34.513455-31.232C264.075636 101.981091 383.860364 46.545455 512 46.545455c119.621818 0 232.122182 48.290909 317.672727 133.46909z m-455.028364 7.33091a23.272727 23.272727 0 0 1 18.152728 42.868363c-112.221091 47.522909-186.693818 157.789091-186.786909 283.927273-8.378182 90.670545-34.909091 156.997818-80.80291 198.050909a23.272727 23.272727 0 0 1-31.022545-34.676364c35.863273-32.093091 58.112-87.668364 65.396364-165.515636a352.465455 352.465455 0 0 1 215.063272-324.654545zM807.098182 888.110545a23.272727 23.272727 0 1 1-41.634909-20.805818c9.099636-18.199273 16.989091-37.189818 23.691636-56.925091 27.531636-81.058909 33.349818-156.346182 29.742546-261.003636l-0.698182-20.363636c-0.232727-7.074909-0.325818-12.381091-0.325818-17.012364a23.272727 23.272727 0 0 1 46.545454 0c0 4.049455 0.093091 8.936727 0.302546 15.546182l0.698181 20.224c3.770182 109.847273-2.420364 189.882182-32.209454 277.573818-7.354182 21.690182-16.058182 42.635636-26.112 62.766545z m37.445818-493.079272a23.272727 23.272727 0 0 1-43.915636 15.453091 305.989818 305.989818 0 0 0-305.640728-203.869091 23.272727 23.272727 0 0 1-2.56-46.498909 352.535273 352.535273 0 0 1 352.116364 234.914909z m-273.850182-125.416728a23.272727 23.272727 0 0 1-7.68 45.917091c-66.513455-11.101091-126.906182 5.376-182.760727 50.059637-35.025455 28.020364-50.176 58.321455-57.879273 104.517818-1.466182 8.843636-2.373818 15.639273-4.421818 32.581818-5.678545 46.312727-10.146909 67.444364-22.853818 92.858182a23.272727 23.272727 0 1 1-41.634909-20.805818c9.541818-19.083636 13.265455-36.584727 18.269091-77.730909 2.164364-17.594182 3.118545-24.808727 4.747636-34.56 9.425455-56.645818 29.719273-97.210182 74.705455-133.189819 66.024727-52.829091 139.729455-72.936727 219.508363-59.648zM215.645091 669.207273a23.272727 23.272727 0 0 1 44.148364 14.731636c-13.428364 40.285091-39.796364 79.825455-78.75491 118.807273a23.272727 23.272727 0 1 1-32.930909-32.907637c34.187636-34.187636 56.576-67.770182 67.537455-100.631272z m444.462545-287.045818a23.272727 23.272727 0 0 1 32.930909-32.907637c41.425455 41.425455 61.672727 102.167273 61.672728 181.038546 0 195.909818-41.495273 343.458909-133.399273 453.748363a23.272727 23.272727 0 1 1-35.770182-29.789091c84.014545-100.840727 122.624-238.033455 122.624-423.959272 0-67.444364-16.337455-116.386909-48.058182-148.130909z m-15.127272 130.094545a23.272727 23.272727 0 0 1-46.545455-0.512c0.698182-60.136727-25.367273-86.178909-86.434909-86.178909-61.067636 0-87.109818 26.065455-86.504727 87.970909-12.660364 189.998545-83.386182 325.026909-212.386909 402.408727a23.272727 23.272727 0 1 1-23.947637-39.889454c114.827636-68.887273 178.199273-189.858909 189.858909-363.799273-0.977455-86.155636 46.126545-133.236364 132.980364-133.236364s133.957818 47.080727 132.980364 133.236364zM488.727273 512a23.272727 23.272727 0 0 1 46.545454 0c0 189.253818-63.581091 341.876364-190.557091 456.145455a23.272727 23.272727 0 0 1-31.138909-34.583273C430.405818 828.392727 488.727273 688.453818 488.727273 512z m109.986909 106.170182a23.272727 23.272727 0 0 1 46.010182 7.074909c-25.181091 163.560727-82.408727 284.392727-172.450909 361.565091a23.272727 23.272727 0 1 1-30.254546-35.328c80.616727-69.12 133.096727-179.898182 156.695273-333.312z",fill:"#FFFAFA","p-id":"1246"}))):null)}})}}]);